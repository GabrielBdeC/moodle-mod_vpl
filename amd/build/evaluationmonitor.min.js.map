{"version":3,"file":"evaluationmonitor.min.js","names":["define","VPLUtil","init","options","showErrorMessage","message","next","window","location","nexturl","action","executionActions","ajaxurl","run","getLastAction","requestAction","done","response","webSocketMonitor","fail"],"sources":["../src/evaluationmonitor.js"],"sourcesContent":["// This file is part of VPL for Moodle - http://vpl.dis.ulpgc.es/\n//\n// VPL for Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// VPL for Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with VPL for Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Evaluation monitoring\n *\n * @copyright 2013 onward Juan Carlos Rodríguez-del-Pino\n * @license http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n * @author Juan Carlos Rodríguez-del-Pino <jcrodriguez@dis.ulpgc.es>\n */\n\ndefine(['mod_vpl/vplutil'], function(VPLUtil) {\n    return {\n        init: function(options) {\n            options.next = function() {\n                window.location = options.nexturl;\n            };\n            /**\n             * Show a error message in a modal dialog.\n             * Allows to go next evaluation.\n             *\n             * @param {string} message Message to shohw in dialog.\n             */\n            function showErrorMessage(message) {\n                VPLUtil.showErrorMessage(message, {\n                    next: options.next\n                });\n            }\n            var action;\n            var executionActions = {\n                'ajaxurl': options.ajaxurl,\n                'run': showErrorMessage,\n                'getLastAction': function() {\n                    action();\n                },\n            };\n            action = function() {\n                VPLUtil.requestAction('evaluate', 'evaluating', {}, options.ajaxurl)\n                .done(\n                        function(response) {\n                            VPLUtil.webSocketMonitor(response, 'evaluate', 'evaluating', executionActions)\n                            .done(options.next)\n                            .fail(showErrorMessage);\n                        }\n                )\n                .fail(showErrorMessage);\n            };\n            action();\n        }\n    };\n});\n"],"mappings":"AAuBAA,MAAM,CAAC,CAAC,iBAAiB,CAAC,CAAE,SAASC,CAAO,CAAE,CAC1C,MAAO,CACHC,IAAI,CAAE,QAAAA,CAASC,CAAO,CAAE,CAUpB,QAAS,CAAAC,CAAgBA,CAACC,CAAO,CAAE,CAC/BJ,CAAO,CAACG,gBAAgB,CAACC,CAAO,CAAE,CAC9BC,IAAI,CAAEH,CAAO,CAACG,IAClB,CAAC,CACL,CAbAH,CAAO,CAACG,IAAI,CAAG,UAAW,CACtBC,MAAM,CAACC,QAAQ,CAAGL,CAAO,CAACM,OAC9B,CAAC,IAYG,CAAAC,CAAM,CACNC,CAAgB,CAAG,CACnBC,OAAA,CAAWT,CAAO,CAACS,OAAO,CAC1BC,GAAA,CAAOT,CAAgB,CACvBU,aAAA,CAAiB,QAAAA,CAAA,CAAW,CACxBJ,CAAM,EACV,CACJ,CAAC,CACDA,CAAM,CAAG,QAAAA,CAAA,CAAW,CAChBT,CAAO,CAACc,aAAa,CAAC,UAAU,CAAE,YAAY,CAAE,CAAC,CAAC,CAAEZ,CAAO,CAACS,OAAO,CAAC,CACnEI,IAAI,CACG,SAASC,CAAQ,CAAE,CACfhB,CAAO,CAACiB,gBAAgB,CAACD,CAAQ,CAAE,UAAU,CAAE,YAAY,CAAEN,CAAgB,CAAC,CAC7EK,IAAI,CAACb,CAAO,CAACG,IAAI,CAAC,CAClBa,IAAI,CAACf,CAAgB,CAC1B,CAAC,CACR,CACAe,IAAI,CAACf,CAAgB,CAC1B,CAAC,CACDM,CAAM,EACV,CACJ,CACJ,CAAC,CAAC"}