{"version":3,"file":"evaluationmonitor.min.js","names":["define","VPLUtil","init","options","next","window","location","nexturl","showErrorMessage","message","action","executionActions","ajaxurl","getLastAction","requestAction","done","response","webSocketMonitor","fail"],"sources":["../src/evaluationmonitor.js"],"sourcesContent":["// This file is part of VPL for Moodle - http://vpl.dis.ulpgc.es/\n//\n// VPL for Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// VPL for Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with VPL for Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Evaluation monitoring\n *\n * @copyright 2013 onward Juan Carlos Rodríguez-del-Pino\n * @license http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n * @author Juan Carlos Rodríguez-del-Pino <jcrodriguez@dis.ulpgc.es>\n */\n\ndefine(['mod_vpl/vplutil'], function(VPLUtil) {\n    return {\n        init: function(options) {\n            options.next = function() {\n                window.location = options.nexturl;\n            };\n            /**\n             * Show a error message in a modal dialog.\n             * Allows to go next evaluation.\n             *\n             * @param {string} message Message to shohw in dialog.\n             */\n            function showErrorMessage(message) {\n                VPLUtil.showErrorMessage(message, {\n                    next: options.next\n                });\n            }\n            var action;\n            var executionActions = {\n                'ajaxurl': options.ajaxurl,\n                'run': showErrorMessage,\n                'getLastAction': function() {\n                    action();\n                },\n            };\n            action = function() {\n                VPLUtil.requestAction('evaluate', 'evaluating', {}, options.ajaxurl)\n                .done(\n                        function(response) {\n                            VPLUtil.webSocketMonitor(response, 'evaluate', 'evaluating', executionActions)\n                            .done(options.next)\n                            .fail(showErrorMessage);\n                        }\n                )\n                .fail(showErrorMessage);\n            };\n            action();\n        }\n    };\n});\n"],"mappings":"AAeA;AACA;AACA;AACA;AACA;AACA;AACA;AAEAA,MAAM,CAAC,CAAC,iBAAiB,CAAC,EAAE,UAASC,OAAO,EAAE;EAC1C,OAAO;IACHC,IAAI,EAAE,SAAAA,CAASC,OAAO,EAAE;MACpBA,OAAO,CAACC,IAAI,GAAG,YAAW;QACtBC,MAAM,CAACC,QAAQ,GAAGH,OAAO,CAACI,OAAO;MACrC,CAAC;MAOD,SAASC,gBAAgBA,CAACC,OAAO,EAAE;QAC/BR,OAAO,CAACO,gBAAgB,CAACC,OAAO,EAAE;UAC9BL,IAAI,EAAED,OAAO,CAACC;QAClB,CAAC,CAAC;MACN;MACA,IAAIM,MAAM;MACV,IAAIC,gBAAgB,GAAG;QACnB,SAAS,EAAER,OAAO,CAACS,OAAO;QAC1B,KAAK,EAAEJ,gBAAgB;QACvB,eAAe,EAAE,SAAAK,CAAA,EAAW;UACxBH,MAAM,EAAE;QACZ;MACJ,CAAC;MACDA,MAAM,GAAG,SAAAA,CAAA,EAAW;QAChBT,OAAO,CAACa,aAAa,CAAC,UAAU,EAAE,YAAY,EAAE,CAAC,CAAC,EAAEX,OAAO,CAACS,OAAO,CAAC,CACnEG,IAAI,CACG,UAASC,QAAQ,EAAE;UACff,OAAO,CAACgB,gBAAgB,CAACD,QAAQ,EAAE,UAAU,EAAE,YAAY,EAAEL,gBAAgB,CAAC,CAC7EI,IAAI,CAACZ,OAAO,CAACC,IAAI,CAAC,CAClBc,IAAI,CAACV,gBAAgB,CAAC;QAC3B,CAAC,CACR,CACAU,IAAI,CAACV,gBAAgB,CAAC;MAC3B,CAAC;MACDE,MAAM,EAAE;IACZ;EACJ,CAAC;AACL,CAAC,CAAC"}