{"version":3,"file":"vplide.min.js","names":["define","$","jqui","VPLUtil","VPLFile","VPLIDEButtons","VPLTerminal","VPLVNCClient","VPLIDE","vplIdeInstance","rootId","options","self","fileManager","adjustTabsTitles","autoResizeTab","showErrorMessage","updateMenu","executionActions","minNumberOfFiles","minfiles","maxNumberOfFiles","maxfiles","restrictedEdit","restrictededitor","example","readOnly","isTeacher","fullScreen","scrollBarWidth","str","rootObj","append","Error","optionsToCheck","loadajaxurl","ajaxurl","activateModification","new","rename","delete","comments","acetheme","sort","multidelete","import","isOptionAllowed","op","console","fontSize","parseInt","dragoverHandler","e","originalEvent","dataTransfer","dropEffect","preventDefault","dropHandler","stopImmediatePropagation","dt","files","length","readSelectedFiles","file","addFile","fileListVisibleIfNeeded","on","restrictedPaste","stopPropagation","menu","menuButtons","tr","fileListContainer","fileList","fileListContent","tabsUl","tabs","resultContainer","result","vplMinWidth","avoidSelectGrade","event","ui","newHeader","hasClass","FileManager","openFiles","modified","version","setVersion","v","getVersion","updateFileList","generateFileList","fileNameExists","name","checkName","toLowerCase","i","getFileName","fileNameIncluded","nameMod","indexOf","twoBlockly","oldname","newname","isBlockly","localClipboard","setClipboard","t","getClipboard","getTabPos","getTheme","theme","setTheme","addTab","fid","hlink","removeTab","find","remove","open","pos","isOpen","getId","push","setGetkeys","delay","close","ptab","splice","fileListVisible","getFilePosById","gotoFile","isClosed","b","vplVisible","show","hide","isFileListVisible","setFontSize","size","terminal","getFontSize","replace","ok","showError","validPath","setContent","contents","setModified","getUniqueId","newfile","encoding","extendToBinary","extendToBlockly","extendToCodeEditor","setFileName","renameFile","isBinary","fileExtension","getContent","showMessage","deleteFile","fileResult","gotoFileName","currentFile","id","arguments","action","fun","args","Array","prototype","slice","shift","apply","currentPos","getFileTab","l","gotoLine","focus","gotoFileLink","a","tag","fname","data","fpos","line","getFilesToSave","ret","resetModified","isModified","clearAnnotations","getFile","getFiles","getDirectoryStructure","structure","isDir","content","addFilePath","fileName","path","split","curdir","p","hasOwnProperty","part","dirIndent","lister","dir","indent","lines","fd","iconFolder","sanitizeText","sname","attrs","iconModified","iconRequired","html","getAction","updateEvaluationNumber","res","nevaluations","text","reductionbyevaluation","freeevaluations","setExtracontent","lastResult","getTerminal","setResultGrade","raw","titleclass","contentclass","titleTag","replaceWith","setResultTab","contentTag","HTMLcontent","setResult","go","fileNames","hasContent","grade","gradeShow","formated","variables","processResult","compilation","evaluation","execution","window","VPLDescription","MathJax","math","Hub","Queue","removeClass","addClass","replaceAll","accordion","children","anot","getAnnotations","j","type","row","heightStyle","header","animate","beforeActivate","width","currentTarget","tabsAir","getTabsAir","outerWidth","resizeTabWidth","diffLeft","position","left","originalPosition","maxWidth","resizable","vplOriginalWidth","diffWidth","originalSize","resizableOptions","containment","resize","start","off","stop","handles","updateTabsHandles","index","disable","resizeHeight","newHeight","outerHeight","offset","top","height","panelHeight","center","newWidth","tabsUlWidth","last","parentScrollLeft","parent","scrollLeft","fileTab","getTabNameId","scroll","finish","oldWidth","planb","css","right","rel","wfl","focusCurrentFile","dialogbaseOptions","extend","message","dialogNew","newFileHandler","keyCode","dialog","val","dialogButtons","title","buttons","setDialogTitleIcon","dialogRename","renameHandler","dialogComments","aboutDialog","OKButtons","shortcutDialog","getShortcuts","next","filter","button","dialogSort","dialogSortButtons","regNoNumber","sorted","newOrder","each","orig","list","sortable","items","placeholder","item","disableSelection","maxHeight","dialogMultidelete","dialogMultideleteButtons","prop","toDeleteList","labelList","label","dialogFontsize","fontsizeSlider","dialogFontFizeButtons","value","slider","ajax","async","url","JSON","stringify","contentType","dataType","min","max","change","dialogAceTheme","acethemeSelect","dialogAceThemeButtons","setUserPreferences","aceTheme","modal","vpl_results","VNCClient","lastConsole","fileSelect","fileSelectHandler","add","originalAction","bindKey","win","mac","filename","icon","trigger","print","editorName","tags","setText","scrollTop","username","setTimeout","location","download","resetFiles","requestAction","done","response","doNothing","fail","postMaxSize","doSave","reg","langConfigParseError","test","parse","SyntaxError","requestsconfirmation","question","yes","setTimeLeft","monitorRunning","processid","getProcessId","executionRequest","acting","isConnected","webSocketMonitor","runAction","XGEOMETRY","getCanvasSize","setLastAction","debugAction","evaluateAction","toggleTimeLeft","is","rightpanelstyle","getHTML","rightPanelButton","launchAction","menuHtml","controlgroup","alwaysActive","enable","nfiles","running","sel","hasUndo","hasRedo","hasSelectAll","hasFind","hasFindReplace","hasNext","getConsole","run","coninfo","ws","parsed","exec","connect","executionURL","URLfavicon","secure","server","portToUse","imgFavicon","attr","VNCpassword","executionPath","URL","log","getLastAction","lastAction","jw","undefined","oldMenuWidth","checkMenuWidth","newMenuWidth","setInterval","allOK","showFileList","r","compilationexecution","saved","afterAll","init"],"sources":["../src/vplide.js"],"sourcesContent":["// This file is part of VPL for Moodle - http://vpl.dis.ulpgc.es/\n//\n// VPL for Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// VPL for Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with VPL for Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * IDE Control\n *\n * @copyright 2017 Juan Carlos Rodríguez-del-Pino\n * @license http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n * @author Juan Carlos Rodríguez-del-Pino <jcrodriguez@dis.ulpgc.es>\n */\n\n/* globals MathJax */\n\ndefine(\n    [\n        'jquery',\n        'jqueryui',\n        'mod_vpl/vplutil',\n        'mod_vpl/vplidefile',\n        'mod_vpl/vplidebutton',\n        'mod_vpl/vplterminal',\n        'mod_vpl/vplvnc',\n    ],\n    function($, jqui, VPLUtil, VPLFile, VPLIDEButtons, VPLTerminal, VPLVNCClient) {\n        if (typeof VPLIDE !== 'undefined') {\n            return VPLIDE;\n        }\n        var vplIdeInstance;\n        var VPLIDE = function(rootId, options) {\n            var self = this;\n            var fileManager;\n            var adjustTabsTitles;\n            var autoResizeTab;\n            var showErrorMessage;\n            var updateMenu;\n            var executionActions;\n            var minNumberOfFiles = options.minfiles || 0;\n            var maxNumberOfFiles = options.maxfiles || 0;\n            var restrictedEdit = options.restrictededitor || options.example;\n            var readOnly = options.example;\n            var isTeacher = options.isTeacher;\n            var fullScreen = false;\n            var scrollBarWidth = VPLUtil.scrollBarWidth();\n            var str = VPLUtil.str;\n            var rootObj = $('#' + rootId);\n            $(\"head\").append('<meta name=\"viewport\" content=\"initial-scale=1\">')\n                          .append('<meta name=\"viewport\" width=\"device-width\">')\n                          .append('<link rel=\"stylesheet\" href=\"../editor/VPLIDE.css\"/>');\n            if (typeof rootObj != 'object') {\n                throw new Error(\"VPL: constructor tag_id not found\");\n            }\n            var optionsToCheck = {\n                'new': true,\n                'rename': true,\n                'delete': true,\n                'save': true,\n                'run': true,\n                'edit': true,\n                'debug': true,\n                'evaluate': true,\n                'import': true,\n                'resetfiles': true,\n                'sort': true,\n                'multidelete': true,\n                'acetheme': true,\n                'console': true,\n                'comments': true\n            };\n            if ((typeof options.loadajaxurl) == 'undefined') {\n                options.loadajaxurl = options.ajaxurl;\n            }\n            (function() {\n                var activateModification = (minNumberOfFiles < maxNumberOfFiles);\n                options.new = activateModification;\n                options.rename = activateModification;\n                options.delete = activateModification;\n                options.comments = options.comments && !options.example;\n                options.acetheme = true;\n            })();\n            options.sort = (maxNumberOfFiles - minNumberOfFiles >= 2);\n            options.multidelete = options.sort;\n            options.import = !restrictedEdit;\n            var isOptionAllowed = function(op) {\n                if (!optionsToCheck[op]) {\n                    return true;\n                }\n                return options[op];\n            };\n            options.console = isOptionAllowed('run') || isOptionAllowed('debug');\n            if ((typeof options.fontSize) == 'undefined') {\n                options.fontSize = 12;\n            }\n            options.fontSize = parseInt(options.fontSize);\n            /**\n             * Handler for dragover event.\n             * @param {object} e event.\n             */\n            function dragoverHandler(e) {\n                if (restrictedEdit) {\n                    e.originalEvent.dataTransfer.dropEffect = 'none';\n                } else {\n                    e.originalEvent.dataTransfer.dropEffect = 'copy';\n                }\n                e.preventDefault();\n            }\n            /**\n             * Handler for drop event.\n             * @param {object} e event.\n             * @returns {boolean}\n             */\n            function dropHandler(e) {\n                if (restrictedEdit) { // No drop allowed.\n                    e.stopImmediatePropagation();\n                    return false;\n                }\n                var dt = e.originalEvent.dataTransfer;\n                // Drop files.\n                if (dt.files.length > 0) {\n                    VPLUtil.readSelectedFiles(dt.files, function(file) {\n                        return fileManager.addFile(file, true, updateMenu, showErrorMessage);\n                    },\n                    function() {\n                        fileManager.fileListVisibleIfNeeded();\n                    });\n                    e.stopImmediatePropagation();\n                    return false;\n                }\n                return false;\n            }\n            rootObj.on('drop', dropHandler);\n            rootObj.on('dragover', dragoverHandler);\n            /**\n             * Handler for paste limited by restrictedEdit var.\n             * @param {object} e event.\n             * @returns {boolean}\n             */\n            function restrictedPaste(e) {\n                if (restrictedEdit) {\n                    e.stopPropagation();\n                    return false;\n                }\n                return true;\n            }\n            // Init editor vars.\n            var menu = $('#vpl_menu');\n            var menuButtons = new VPLIDEButtons(menu, isOptionAllowed);\n            var tr = $('#vpl_tr');\n            var fileListContainer = $('#vpl_filelist');\n            var fileList = $('#vpl_filelist_header');\n            var fileListContent = $('#vpl_filelist_content');\n            var tabsUl = $('#vpl_tabs_ul');\n            var tabs = $('#vpl_tabs');\n            var resultContainer = $('#vpl_results');\n            var result = $('#vpl_results_accordion');\n            fileListContainer.vplMinWidth = 80;\n            resultContainer.vplMinWidth = 100;\n            /**\n             * Avoids selecting grade.\n             * @param {object} event Unuse.\n             * @param {object} ui UI origen.\n             * @returns {boolean}\n             */\n            function avoidSelectGrade(event, ui) {\n                if (\"newHeader\" in ui) {\n                    if (ui.newHeader.hasClass('vpl_ide_accordion_t_grade')) {\n                        return false;\n                    }\n                }\n                return true;\n            }\n            /**\n             * Constructor of FileManager objects\n             */\n            function FileManager() {\n                var tabsUl = $('#vpl_tabs_ul');\n                $('#vpl_tabs').tabs();\n                var tabs = $('#vpl_tabs').tabs(\"widget\");\n                var files = [];\n                var openFiles = [];\n                var modified = true;\n                var self = this;\n                (function() {\n                    var version;\n                    self.setVersion = function(v) {\n                       version = v;\n                    };\n                    self.getVersion = function() {\n                       return version;\n                    };\n                })();\n                this.updateFileList = function() {\n                    self.generateFileList();\n                };\n                this.fileNameExists = function(name) {\n                    var checkName = name.toLowerCase();\n                    for (var i = 0; i < files.length; i++) {\n                        if (files[i].getFileName().toLowerCase() == checkName) {\n                            return i;\n                        }\n                    }\n                    return -1;\n                };\n                /**\n                 * Checks if name is included in current files names\n                 * @param {string} name Name of file\n                 * @returns {boolean} if found or not found\n                 */\n                function fileNameIncluded(name) {\n                    var checkName = name.toLowerCase() + '/';\n                    for (var i = 0; i < files.length; i++) {\n                        var nameMod = files[i].getFileName().toLowerCase() + '/';\n                        // Check for name as directory existent.\n                        if (nameMod.indexOf(checkName) === 0 || checkName.indexOf(nameMod) === 0) {\n                            return true;\n                        }\n                    }\n                    return false;\n                }\n                /**\n                 * Checks if changing file name results in two blovkly files\n                 * @param {string} oldname The old file name\n                 * @param {string} newname The new file name\n                 * @returns {boolean} if results two two blovkly files\n                 */\n                function twoBlockly(oldname, newname) {\n                    if (VPLUtil.isBlockly(oldname)) {\n                        return false;\n                    }\n                    if (VPLUtil.isBlockly(newname)) {\n                        for (var i = 0; i < files.length; i++) {\n                            if (VPLUtil.isBlockly(files[i].getFileName())) {\n                                return true;\n                            }\n                        }\n                    }\n                    return false;\n                }\n                this.restrictedPaste = restrictedPaste;\n                this.dropHandler = dropHandler;\n                this.dragoverHandler = dragoverHandler;\n                this.readOnly = readOnly;\n                this.restrictedEdit = restrictedEdit;\n                this.adjustTabsTitles = adjustTabsTitles;\n                this.minNumberOfFiles = minNumberOfFiles;\n                this.scrollBarWidth = scrollBarWidth;\n                var localClipboard = \"\";\n                this.setClipboard = function(t) {\n                    localClipboard = t;\n                };\n                this.getClipboard = function() {\n                    return localClipboard;\n                };\n                this.getTabPos = function(file) {\n                    for (var i = 0; i < openFiles.length; i++) {\n                        if (openFiles[i] == file) {\n                            return i;\n                        }\n                    }\n                    return openFiles.length;\n                };\n                this.getTheme = function() {\n                    return options.theme;\n                };\n                this.setTheme = function(theme) {\n                    options.theme = theme;\n                    for (var i = 0; i < files.length; i++) {\n                        files[i].setTheme(theme);\n                    }\n                };\n                this.addTab = function(fid) {\n                    var hlink = '<a href=\"#vpl_file' + fid + '\"></a>';\n                    tabsUl.append('<li id=\"vpl_tab_name' + fid + '\">' + hlink + '</li>');\n                    tabs.append('<div id=\"vpl_file' + fid + '\" class=\"vpl_ide_file\"></div>');\n                };\n                this.removeTab = function(fid) {\n                    tabsUl.find('#vpl_tab_name' + fid).remove();\n                    tabs.find('#vpl_file' + fid).remove();\n                };\n                this.open = function(pos) {\n                    var file;\n                    if (typeof pos == 'object') {\n                        file = pos;\n                    } else {\n                        file = files[pos];\n                    }\n                    if (file.isOpen()) {\n                        return;\n                    }\n                    var fid = file.getId();\n                    self.addTab(fid);\n                    openFiles.push(file);\n                    menuButtons.setGetkeys(file.open());\n                    tabs.tabs('refresh');\n                    adjustTabsTitles(false);\n                    VPLUtil.delay('updateFileList', self.updateFileList);\n                    VPLUtil.delay('updateMenu', updateMenu);\n                };\n                this.close = function(file) {\n                    if (!file.isOpen()) {\n                        return;\n                    }\n                    var pos;\n                    var fid = file.getId();\n                    file.close();\n                    self.removeTab(fid);\n                    var ptab = self.getTabPos(file);\n                    openFiles.splice(ptab, 1);\n                    tabs.tabs('refresh');\n                    adjustTabsTitles(false);\n                    self.fileListVisible(true);\n                    VPLUtil.delay('updateFileList', self.updateFileList);\n                    VPLUtil.delay('adjustTabsTitles', adjustTabsTitles, false);\n                    if (openFiles.length > ptab) {\n                        pos = self.getFilePosById(openFiles[ptab].getId());\n                        self.gotoFile(pos, 'c');\n                        return;\n                    }\n                    if (ptab > 0) {\n                        pos = self.getFilePosById(openFiles[ptab - 1].getId());\n                        self.gotoFile(pos, 'c');\n                        return;\n                    }\n                };\n                this.isClosed = function(pos) {\n                    return !files[pos].isOpen();\n                };\n                this.fileListVisible = function(b) {\n                    if (b === fileListContainer.vplVisible) {\n                        return;\n                    }\n                    if (b) {\n                        VPLUtil.delay('fileListVisible', function() {\n                            fileListContainer.vplVisible = true;\n                            self.updateFileList();\n                            fileListContainer.show();\n                            autoResizeTab();\n                         });\n                    } else {\n                        VPLUtil.delay('fileListVisible', function() {\n                            fileListContainer.vplVisible = false;\n                            fileListContainer.hide();\n                            autoResizeTab();\n                         });\n                    }\n                };\n                this.isFileListVisible = function() {\n                    return fileListContainer.vplVisible;\n                };\n                this.fileListVisibleIfNeeded = function() {\n                    if (this.isFileListVisible()) {\n                        return;\n                    }\n                    for (var i = 0; i < files.length; i++) {\n                        if (!files[i].isOpen()) {\n                            this.fileListVisible(true);\n                            return;\n                        }\n                    }\n                };\n                this.setFontSize = function(size) {\n                    options.fontSize = size;\n                    for (var i = 0; i < files.length; i++) {\n                        files[i].setFontSize(size);\n                    }\n                    terminal.setFontSize(size);\n                };\n                this.getFontSize = function() {\n                    return options.fontSize;\n                };\n                this.addFile = function(file, replace, ok, showError) {\n                    if ((typeof file.name != 'string') || !VPLUtil.validPath(file.name)) {\n                        showError(str('incorrect_file_name') + ' (' + file.name + ')');\n                        return false;\n                    }\n                    if (replace !== true) {\n                        replace = false;\n                    }\n                    var pos = this.fileNameExists(file.name);\n                    if (pos != -1) {\n                        if (replace) {\n                            files[pos].setContent(file.contents);\n                            self.setModified();\n                            ok();\n                            VPLUtil.delay('updateFileList', self.updateFileList);\n                            return file;\n                        } else {\n                            showError(str('filenotadded', file.name));\n                            return false;\n                        }\n                    }\n                    if (fileNameIncluded(file.name) || twoBlockly('', file.name)) {\n                        showError(str('filenotadded', file.name));\n                        return false;\n                    }\n                    if (files.length >= maxNumberOfFiles) {\n                        showError(str('maxfilesexceeded') + ' (' + maxNumberOfFiles + ')');\n                        return false;\n                    }\n                    var fid = VPLUtil.getUniqueId();\n                    var newfile = new VPLFile(fid, file.name, file.contents, this, vplIdeInstance);\n                    if (file.encoding == 1) {\n                        newfile.extendToBinary();\n                    } else {\n                        if (VPLUtil.isBlockly(file.name)) {\n                            newfile.extendToBlockly();\n                        } else {\n                            newfile.extendToCodeEditor();\n                        }\n                    }\n                    newfile.setFileName(file.name);\n                    files.push(newfile);\n                    self.setModified();\n                    if (files.length > 5) {\n                        self.fileListVisible(true);\n                    }\n                    ok();\n                    return newfile;\n                };\n                this.renameFile = function(oldname, newname, showError) {\n                    var pos = this.fileNameExists(oldname);\n                    try {\n                        if (pos == -1) {\n                            throw new Error(\"Internal error: File name not found\");\n                        }\n                        if (pos < minNumberOfFiles) {\n                            throw new Error(\"Internal error: Renaming requested filename\");\n                        }\n                        if (files[pos].getFileName() == newname) {\n                            return true; // Equals name file.\n                        }\n                        if (!VPLUtil.validPath(newname) ||\n                               fileNameIncluded(newname) ||\n                               twoBlockly(oldname, newname)) {\n                            throw str('incorrect_file_name');\n                        }\n                        if (VPLUtil.isBinary(oldname) && VPLUtil.fileExtension(oldname) != VPLUtil.fileExtension(newname)) {\n                            throw str('incorrect_file_name');\n                        }\n                        if (VPLUtil.isBlockly(oldname) != VPLUtil.isBlockly(newname)) {\n                            if (files[pos].getContent() > '') {\n                                showMessage(str('delete_file_fq', oldname), {\n                                    ok: function() {\n                                        var file = {\n                                            name: newname,\n                                            contents: '',\n                                            encoding: 0\n                                        };\n                                        fileManager.deleteFile(oldname, showError);\n                                        var fileResult = fileManager.addFile(file, false, updateMenu, showErrorMessage);\n                                        if (fileResult) {\n                                            fileManager.gotoFileName(newname);\n                                        }\n                                    }\n                                });\n                            } else {\n                                var file = {\n                                    name: newname,\n                                    contents: '',\n                                    encoding: 0\n                                };\n                                fileManager.deleteFile(oldname, showError);\n                                var fileResult = fileManager.addFile(file, false, updateMenu, showError);\n                                if (fileResult) {\n                                    fileManager.gotoFileName(newname);\n                                }\n                            }\n                            return true;\n                        }\n                        files[pos].setFileName(newname);\n                    } catch (e) {\n                        showError(str('filenotrenamed', newname) + ': ' + e);\n                        return false;\n                    }\n                    self.setModified();\n                    adjustTabsTitles(false);\n                    VPLUtil.delay('updateFileList', self.updateFileList);\n                    return true;\n                };\n                this.deleteFile = function(name, showError) {\n                    var pos = this.fileNameExists(name);\n                    if (pos == -1) {\n                        showError(str('filenotdeleted', name));\n                        return false;\n                    }\n                    if (pos < minNumberOfFiles) {\n                        showError(str('filenotdeleted', name));\n                        return false;\n                    }\n                    self.setModified();\n                    self.close(files[pos]);\n                    files.splice(pos, 1);\n                    VPLUtil.delay('updateFileList', self.updateFileList);\n                    return true;\n                };\n                this.currentFile = function() {\n                    var id = tabs.tabs('option', 'active');\n                    if (id in openFiles) {\n                        var file = openFiles[id];\n                        if (arguments.length === 0) {\n                            return file;\n                        }\n                        var action = arguments[0];\n                        if (typeof file[action] === 'function') {\n                            var fun = file[action];\n                            var args = Array.prototype.slice(arguments);\n                            args.shift();\n                            return fun.apply(file, args);\n                        }\n                    }\n                    return false;\n                };\n                this.currentPos = function() {\n                    return tabs.tabs('option', 'active');\n                };\n                this.getFileTab = function(id) {\n                    for (var i = 0; i < openFiles.length; i++) {\n                        if (openFiles[i].getId() == id) {\n                            return i;\n                        }\n                    }\n                    return -1;\n                };\n                this.getFilePosById = function(id) {\n                    for (var i = 0; i < files.length; i++) {\n                        if (files[i].getId() == id) {\n                            return i;\n                        }\n                    }\n                    return -1;\n                };\n                this.gotoFile = function(pos, l) {\n                    var file = files[pos];\n                    self.open(file);\n                    tabs.tabs('option', 'active', self.getFileTab(file.getId()));\n                    if (l !== 'c') {\n                        file.gotoLine(parseInt(l, 10));\n                    }\n                    file.focus();\n                };\n                this.gotoFileLink = function(a) {\n                    var tag = $(a);\n                    var fname = tag.data('file');\n                    var fpos = -1;\n                    if (fname > '') {\n                        fpos = this.fileNameExists(fname);\n                    } else {\n                        fpos = self.getFilePosById(tag.data('fileid'));\n                    }\n                    if (fpos >= 0) {\n                        var line = tag.data('line');\n                        if (typeof line == 'undefined') {\n                            line = 'c';\n                        }\n                        self.gotoFile(fpos, line);\n                        return true;\n                    }\n                    return false;\n                };\n                this.gotoFileName = function(fname, line) {\n                    var fpos = this.fileNameExists(fname);\n                    if (fpos >= 0) {\n                        if (typeof line == 'undefined') {\n                            line = 'c';\n                        }\n                        self.gotoFile(fpos, line);\n                        return true;\n                    }\n                    return false;\n                };\n                this.getFilesToSave = function() {\n                    var ret = [];\n                    for (var i = 0; i < files.length; i++) {\n                        var file = {};\n                        file.name = files[i].getFileName();\n                        file.contents = files[i].getContent();\n                        file.encoding = files[i].isBinary() ? 1 : 0;\n                        ret.push(file);\n                    }\n                    return ret;\n                };\n                this.resetModified = function() {\n                    modified = false;\n                    for (var i = 0; i < files.length; i++) {\n                        files[i].resetModified();\n                    }\n                    VPLUtil.delay('updateMenu', updateMenu);\n                    VPLUtil.delay('updateFileList', self.updateFileList);\n                };\n                this.setModified = function() {\n                    modified = true;\n                    VPLUtil.delay('updateFileList', self.updateFileList);\n                    VPLUtil.delay('updateMenu', updateMenu);\n                };\n                this.isModified = function() {\n                    return modified;\n                };\n                this.length = function() {\n                    return files.length;\n                };\n                this.clearAnnotations = function() {\n                    for (var i = 0; i < files.length; i++) {\n                        files[i].clearAnnotations();\n                    }\n                };\n                this.getFile = function(i) {\n                    return files[i];\n                };\n                this.getFiles = function() {\n                    return files;\n                };\n                this.getDirectoryStructure = function() {\n                    var structure = {\n                        isDir: true,\n                        content: {}\n                    };\n                    /**\n                     * Adds a new file the structure of directories\n                     * @param {int} i Index of file to add in the file array\n                     */\n                    function addFilePath(i) {\n                        var file = files[i];\n                        var fileName = file.getFileName();\n                        var path = fileName.split(\"/\");\n                        var curdir = structure;\n                        for (var p in path) {\n                            if (path.hasOwnProperty(p)) {\n                                var part = path[p];\n                                if (p == path.length - 1) { // File.\n                                    curdir.content[part] = {\n                                        isDir: false,\n                                        content: file,\n                                        pos: i\n                                    };\n                                } else {\n                                    if (!curdir.content[part]) { // New dir.\n                                        curdir.content[part] = {\n                                            isDir: true,\n                                            content: {}\n                                        };\n                                    }\n                                    // Descend Dir.\n                                    curdir = curdir.content[part];\n                                }\n                            }\n                        }\n                    }\n                    for (var i in files) {\n                        if (files.hasOwnProperty(i)) {\n                            addFilePath(i);\n                        }\n                    }\n                    return structure;\n                };\n                this.generateFileList = function() {\n                    if (!self.isFileListVisible()) {\n                        return;\n                    }\n                    var dirIndent = '<span class=\"vpl_ide_dirindent\"></span>';\n                    /**\n                     * Generates an array of string with the HTML code to represent the list of IDE files\n                     * @param {Object} dir Current directory\n                     * @param {int} indent Html code to indent subdirectories\n                     * @param {Array} lines Output. Each line contains the HTML to represent an IDE file\n                     */\n                    function lister(dir, indent, lines) {\n                        for (var name in dir.content) {\n                            if (dir.content.hasOwnProperty(name)) {\n                                var fd = dir.content[name];\n                                if (fd.isDir) {\n                                    lines.push(indent + VPLUtil.iconFolder() + VPLUtil.sanitizeText(name));\n                                    lister(fd, indent + dirIndent, lines);\n                                } else {\n                                    var file = fd.content;\n                                    var sname = VPLUtil.sanitizeText(name);\n                                    var path = VPLUtil.sanitizeText(file.getFileName());\n                                    if (file.isOpen()) {\n                                        sname = '<b>' + sname + '</b>';\n                                    }\n                                    var attrs = 'href=\"#\" data-fileid=\"' + file.getId() + '\" title=\"' + path + '\"';\n                                    var line = '<a ' + attrs + '>' + sname + '</a>';\n                                    if (file.isModified()) {\n                                        line = VPLUtil.iconModified() + line;\n                                    }\n                                    if (fd.pos < minNumberOfFiles) {\n                                        line = line + VPLUtil.iconRequired();\n                                    }\n                                    lines.push(indent + line);\n                                }\n                            }\n                        }\n                    }\n\n                    var structure = self.getDirectoryStructure();\n                    var lines = [];\n                    var html = '';\n                    lister(structure, '', lines);\n                    for (var i = 0; i < lines.length; i++) {\n                        html += lines[i] + '<br>';\n                    }\n                    fileListContent.html('<div>' + html + '</div>');\n                };\n                tabsUl.on('click', 'span.vpl_ide_closeicon', function() {\n                    fileManager.close(fileManager.currentFile());\n                });\n                tabsUl.on('dblclick', 'span.vpl_ide_closeicon', menuButtons.getAction('delete'));\n                tabsUl.on('dblclick', 'a', menuButtons.getAction('rename'));\n                fileListContent.on('dblclick', 'a', menuButtons.getAction('rename'));\n\n            }\n            this.updateEvaluationNumber = function(res) {\n                if (typeof res.nevaluations != 'undefined') {\n                    var text = res.nevaluations;\n                    if (typeof res.reductionbyevaluation != 'undefined'\n                         && res.reductionbyevaluation > ''\n                         && res.reductionbyevaluation != 0) {\n                        if (res.freeevaluations != 0) {\n                            text = text + '/' + res.freeevaluations;\n                        }\n                        text = text + ' -' + res.reductionbyevaluation;\n                    }\n                    menuButtons.setExtracontent('evaluate', text);\n                }\n            };\n            this.lastResult = null;\n            this.getTerminal = function() {\n                return terminal;\n            };\n            this.setResultGrade = function(content, raw) {\n                var name = 'grade';\n                var titleclass = 'vpl_ide_accordion_t_' + name;\n                var contentclass = 'vpl_ide_accordion_c_' + name;\n                if (result.find('.' + contentclass).length == 0) {\n                    result.append('<div class=\"' + titleclass + '\"></div>');\n                    result.append('<div class=\"' + contentclass + '\"></div>');\n                }\n                if (typeof raw == 'undefined') {\n                    return result.find('h4.' + titleclass).length > 0;\n                }\n                var titleTag = result.find('.' + titleclass);\n                if (content > '') {\n                    titleTag.replaceWith('<h4 class=\"' + titleclass + '\">' + content + '</h4>');\n                    return true;\n                } else {\n                    titleTag.replaceWith('<div class=\"' + titleclass + '\"></div>');\n                    return false;\n                }\n            };\n            this.setResultTab = function(name, content, raw) {\n                var titleclass = 'vpl_ide_accordion_t_' + name;\n                var contentclass = 'vpl_ide_accordion_c_' + name;\n                if (result.find('.' + contentclass).length == 0) {\n                    result.append('<div class=\"' + titleclass + '\"></div>');\n                    result.append('<div class=\"' + contentclass + '\"></div>');\n                }\n                if (typeof raw == 'undefined') {\n                    return result.find('h4.' + titleclass).length > 0;\n                }\n                var titleTag = result.find('.' + titleclass);\n                var contentTag = result.find('.' + contentclass);\n                var HTMLcontent = $('<div>' + content + '</div>');\n                HTMLcontent.find('h4').replaceWith(function() {\n                    return $(\"<h5>\").append($(this).contents());\n                });\n                if (contentTag.html() == HTMLcontent.html()) {\n                    return content > '';\n                }\n                if (content > '') {\n                    titleTag.replaceWith('<h4 class=\"' + titleclass + '\">' + str(name) + '</h4>');\n                    contentTag.replaceWith('<div class=\"ui-widget ' + contentclass + '\">' + HTMLcontent.html() + '</div>');\n                    return true;\n                } else {\n                    titleTag.replaceWith('<div class=\"' + titleclass + '\"></div>');\n                    contentTag.replaceWith('<div class=\"' + contentclass + '\"></div>');\n                    return false;\n                }\n            };\n            this.setResult = function(res, go) {\n                self.updateEvaluationNumber(res);\n                var files = fileManager.getFiles();\n                var fileNames = [];\n                var i;\n                for (i = 0; i < files.length; i++) {\n                    fileNames[i] = files[i].getFileName();\n                    files[i].clearAnnotations();\n                }\n                var show = false;\n                var hasContent;\n                var grade = VPLUtil.sanitizeText(res.grade);\n                var gradeShow;\n                var formated;\n                gradeShow = self.setResultGrade(grade, res.grade);\n                show = show || gradeShow;\n                hasContent = self.setResultTab('variables', res.variables, res.variables);\n                show = show || hasContent;\n                formated = VPLUtil.processResult(res.compilation, fileNames, files, true, false);\n                hasContent = self.setResultTab('compilation', formated, res.compilation);\n                show = show || hasContent;\n                formated = VPLUtil.processResult(res.evaluation, fileNames, files, false, false);\n                hasContent = self.setResultTab('comments', formated, res.evaluation);\n                show = show || hasContent;\n                hasContent = self.setResultTab('chat_gpt', 'oi', 'oi');\n                show = show || hasContent;\n                formated = VPLUtil.sanitizeText(res.execution);\n                hasContent = self.setResultTab('execution', formated, res.execution);\n                show = show || hasContent;\n                hasContent = self.setResultTab('description', window.VPLDescription, window.VPLDescription);\n                if (hasContent && typeof MathJax == 'object') { // MathJax workaround.\n                    var math = result.find(\".vpl_ide_accordion_c_description\")[0];\n                    MathJax.Hub.Queue([\"Typeset\", MathJax.Hub, math]);\n                }\n                show = show || hasContent;\n                if (show) {\n                    resultContainer.removeClass();\n                    resultContainer.addClass([\"vpl_ide_results\", (fileManager.getTheme() == \"terminal\" ? \"ace-terminal-theme\" : \"ace-\" + (fileManager.getTheme() || 'chrome').replaceAll(\"_\",\"-\"))]);\n                    resultContainer.show();\n                    resultContainer.vplVisible = true;\n                    result.accordion(\"refresh\");\n                    result.accordion('option', 'active', gradeShow ? 1 : 0);\n                    result.children().removeClass(\"ui-widget-content\");\n                    for (i = 0; i < files.length; i++) {\n                        var anot = files[i].getAnnotations();\n                        for (var j = 0; j < anot.length; j++) {\n                            if (go || anot[j].type == 'error') {\n                                fileManager.gotoFile(i, anot[j].row + 1);\n                                break;\n                            }\n                        }\n                    }\n                    $('#vpl_ide_rightpanel').show();\n                } else {\n                    resultContainer.hide();\n                    resultContainer.vplVisible = false;\n                    $('#vpl_ide_rightpanel').hide();\n                }\n                VPLUtil.delay('autoResizeTab', autoResizeTab);\n            };\n\n            result.accordion({\n                heightStyle: 'fill',\n                header: 'h4',\n                animate: false,\n                beforeActivate: avoidSelectGrade,\n            });\n            resultContainer.width(2 * resultContainer.vplMinWidth);\n            result.on('click', 'a', function(event) {\n                if (fileManager.gotoFileLink(event.currentTarget)) {\n                    event.preventDefault();\n                }\n            });\n            resultContainer.vplVisible = false;\n            resultContainer.hide();\n\n            fileListContainer.addClass('ui-tabs ui-widget ui-widget-content ui-corner-all');\n            fileList.text(str('filelist'));\n            fileList.html(VPLUtil.iconFolder() + fileList.html());\n            fileList.addClass(\"ui-widget-header ui-button-text-only ui-corner-all\");\n            fileListContent.addClass(\"ui-widget ui-corner-all\");\n            fileListContainer.width(2 * fileListContainer.vplMinWidth);\n            fileListContainer.on('click', 'a', function(event) {\n                event.preventDefault();\n                fileManager.gotoFileLink(event.currentTarget);\n            });\n            fileListContainer.vplVisible = false;\n            fileListContainer.hide();\n            var tabsAir = false;\n            /**\n             * Returns separation space\n             * @returns {int} size in pixels\n             */\n            function getTabsAir() {\n                if (tabsAir === false) {\n                    tabsAir = (tabs.outerWidth(true) - tabs.width()) / 2;\n                }\n                return tabsAir;\n            }\n            /**\n             * Resize tab width\n             * @param {Event} e Unused\n             * @param {Object} ui UI object\n             */\n            function resizeTabWidth(e, ui) {\n                var diffLeft = ui.position.left - ui.originalPosition.left;\n                var maxWidth;\n                if (diffLeft !== 0) {\n                    maxWidth = tabs.width() + fileListContainer.width() - fileListContainer.vplMinWidth;\n                    tabs.resizable('option', 'maxWidth', maxWidth);\n                    fileListContainer.width(fileListContainer.vplOriginalWidth + diffLeft);\n                } else {\n                    maxWidth = tabs.width() + resultContainer.width() - resultContainer.vplMinWidth;\n                    tabs.resizable('option', 'maxWidth', maxWidth);\n                    var diffWidth = ui.size.width - ui.originalSize.width;\n                    resultContainer.width(resultContainer.vplOriginalWidth - diffWidth);\n                }\n                fileManager.currentFile('adjustSize');\n            }\n            var resizableOptions = {\n                containment: 'parent',\n                resize: resizeTabWidth,\n                start: function() {\n                    $(window).off('resize', autoResizeTab);\n                    tabs.resizable('option', 'minWidth', 100);\n                    if (resultContainer.vplVisible) {\n                        resultContainer.vplOriginalWidth = resultContainer.width();\n                    }\n                    if (fileListContainer.vplVisible) {\n                        fileListContainer.vplOriginalWidth = fileListContainer.width();\n                    }\n                },\n                stop: function(e, ui) {\n                    resizeTabWidth(e, ui);\n                    tabs.resizable('option', 'maxWidth', 100000);\n                    tabs.resizable('option', 'minWidth', 0);\n                    autoResizeTab();\n                    $(window).on('resize', autoResizeTab);\n                },\n                handles: \"\"\n            };\n            tabs.resizable(resizableOptions);\n             /**\n              * Updates handles for internal IDE resize\n              */\n            function updateTabsHandles() {\n                var handles = ['e', 'w', 'e', 'e, w'];\n                var index = 0;\n                index += fileListContainer.vplVisible ? 1 : 0;\n                index += resultContainer.vplVisible ? 2 : 0;\n                tabs.resizable('destroy');\n                resizableOptions.handles = handles[index];\n                resizableOptions.disable = index === 0;\n                tabs.resizable(resizableOptions);\n            }\n            /**\n             * Resize the IDE height\n             */\n            function resizeHeight() {\n                var newHeight = $(window).outerHeight();\n                newHeight -= menu.offset().top + menu.height() + (fullScreen ? getTabsAir() : 20);\n                if (newHeight < 150) {\n                    newHeight = 150;\n                }\n                tr.height(newHeight);\n                var panelHeight = newHeight - 3 * getTabsAir();\n                tabs.height(panelHeight);\n                if (resultContainer.vplVisible) {\n                    resultContainer.height(panelHeight + getTabsAir());\n                    result.accordion('refresh');\n                }\n                if (fileListContainer.vplVisible) {\n                    fileListContent.height(panelHeight - (fileList.outerHeight() + getTabsAir()));\n                    fileListContainer.height(panelHeight);\n                }\n            }\n            adjustTabsTitles = function(center) {\n                var newWidth = tabs.width();\n                var tabsUlWidth = 0;\n                tabsUl.width(100000);\n                var last = tabsUl.children('li:visible').last();\n                if (last.length) {\n                    var parentScrollLeft = tabsUl.parent().scrollLeft();\n                    tabsUlWidth = parentScrollLeft + last.position().left + last.width() + tabsAir;\n                    tabsUl.width(tabsUlWidth);\n                    var file = fileManager.currentFile();\n                    if (file && center) {\n                        var fileTab = $(file.getTabNameId());\n                        var scroll = parentScrollLeft + fileTab.position().left;\n                        scroll -= (newWidth - fileTab.outerWidth()) / 2;\n                        if (scroll < 0) {\n                            scroll = 0;\n                        }\n                        tabsUl.parent().finish().animate({\n                            scrollLeft: scroll\n                        }, 'slow');\n                    }\n                }\n                if (tabsUlWidth < newWidth) {\n                    tabsUl.width('');\n                }\n            };\n            autoResizeTab = function() {\n                var oldWidth = tabs.width();\n                var newWidth = menu.width();\n                var planb = false;\n                updateTabsHandles();\n                tr.width(menu.outerWidth());\n                if (fileListContainer.vplVisible) {\n                    var left = fileListContainer.outerWidth() + tabsAir;\n                    oldWidth += left;\n                    if (left >= 100) {\n                        newWidth -= left;\n                        tabs.css('left', left);\n                    } else {\n                        planb = true;\n                    }\n                } else {\n                    tabs.css('left', 0);\n                }\n                if (resultContainer.vplVisible) {\n                    var right = resultContainer.outerWidth() + tabsAir;\n                    oldWidth += right;\n                    newWidth -= right;\n                    if (newWidth < 100) {\n                        planb = true;\n                    }\n                }\n                if (planb) {\n                    var rel = menu.width() / oldWidth;\n                    var wfl = 0;\n                    if (fileListContainer.vplVisible) {\n                        wfl = fileListContainer.width() * rel;\n                        fileListContainer.width(wfl - tabsAir);\n                        wfl += tabsAir;\n                        tabs.css('left', wfl);\n                    }\n                    tabs.width(tabs.width() * rel);\n                    if (resultContainer.vplVisible) {\n                        resultContainer.width(menu.width() - (wfl + tabs.width() + tabsAir));\n                    }\n                } else {\n                    tabs.width(newWidth);\n                }\n                adjustTabsTitles(true);\n                resizeHeight();\n                fileManager.currentFile('adjustSize');\n            };\n            /**\n             * Transfer focus to current file\n             */\n            function focusCurrentFile() {\n                fileManager.currentFile('focus');\n            }\n            var dialogbaseOptions = $.extend({}, {\n                close: focusCurrentFile\n            }, VPLUtil.dialogbaseOptions);\n            /**\n             * Shows a dialog with a message.\n             * @param {string} message\n             * @param {Object} options icon, title, actions handler (ok, yes, no, close)\n             * @returns {JQuery} JQueryUI Dialog object already open\n             */\n            function showMessage(message, options) {\n                return VPLUtil.showMessage(message, $.extend({}, dialogbaseOptions, options));\n            }\n            showErrorMessage = function(message) {\n                return VPLUtil.showErrorMessage(message, {\n                    close: focusCurrentFile\n                });\n            };\n\n            var dialogNew = $('#vpl_ide_dialog_new');\n            /**\n             * The event handler for the new file action\n             * @param {Object} event\n             * @return {boolean}\n             */\n            function newFileHandler(event) {\n                if (!(event.type == 'click' || ((event.type == 'keypress') && event.keyCode == 13))) {\n                    return true;\n                }\n                dialogNew.dialog('close');\n                var file = {\n                    name: $('#vpl_ide_input_newfilename').val(),\n                    contents: '',\n                    encoding: 0\n                };\n                var newfile = fileManager.addFile(file, false, updateMenu, showErrorMessage);\n                if (newfile) {\n                    fileManager.open(newfile);\n                    tabs.tabs('option', 'active', fileManager.getTabPos(newfile));\n                    newfile.focus();\n                    return true;\n                }\n                return false;\n            }\n\n            var dialogButtons = {};\n            dialogButtons[str('ok')] = newFileHandler;\n            dialogButtons[str('cancel')] = function() {\n                $(this).dialog('close');\n            };\n            dialogNew.find('input').on('keypress', newFileHandler);\n            dialogNew.dialog($.extend({}, dialogbaseOptions, {\n                title: str('create_new_file'),\n                buttons: dialogButtons\n            }));\n            VPLUtil.setDialogTitleIcon(dialogNew, 'new');\n\n            var dialogRename = $('#vpl_ide_dialog_rename');\n            /**\n             * The event handler for the rename current file action\n             * @param {Object} event\n             */\n            function renameHandler(event) {\n                if (!(event.type == 'click' || ((event.type == 'keypress') && event.keyCode == 13))) {\n                    return;\n                }\n                dialogRename.dialog('close');\n                fileManager.renameFile(fileManager.currentFile('getFileName'),\n                        $('#vpl_ide_input_renamefilename').val(), showErrorMessage);\n                event.preventDefault();\n            }\n            dialogRename.find('input').on('keypress', renameHandler);\n            dialogButtons[str('ok')] = renameHandler;\n            dialogRename.dialog($.extend({}, dialogbaseOptions, {\n                open: function() {\n                    $('#vpl_ide_input_renamefilename').val(fileManager.currentFile('getFileName'));\n                },\n                title: str('rename_file'),\n                buttons: dialogButtons\n            }));\n            VPLUtil.setDialogTitleIcon(dialogRename, 'rename');\n\n            dialogButtons[str('ok')] = function() {\n                $(this).dialog('close');\n            };\n            var dialogComments = $('#vpl_ide_dialog_comments');\n            dialogComments.dialog($.extend({}, dialogbaseOptions, {\n                title: str('comments'),\n                width: '40em',\n                buttons: dialogButtons\n            }));\n            VPLUtil.setDialogTitleIcon(dialogComments, 'comments');\n\n            $('#vpl_ide_input_comments').width('30em');\n            var aboutDialog = $('#vpl_ide_dialog_about');\n            var OKButtons = {};\n            OKButtons[str('ok')] = function() {\n                $(this).dialog('close');\n            };\n            var shortcutDialog = $('#vpl_ide_dialog_shortcuts');\n            shortcutDialog.dialog($.extend({}, dialogbaseOptions, {\n                open: function() {\n                    var html = menuButtons.getShortcuts(fileManager.currentFile('getEditor'));\n                    $('#vpl_ide_dialog_shortcuts').html(html);\n                },\n                title: str('shortcuts'),\n                width: 400,\n                height: 300,\n                buttons: OKButtons\n            }));\n            shortcutDialog.dialog('option', 'height', 300);\n            VPLUtil.setDialogTitleIcon(shortcutDialog, 'shortcuts');\n\n            OKButtons[str('shortcuts')] = function() {\n                $(this).dialog('close');\n                shortcutDialog.dialog('open');\n            };\n            aboutDialog.dialog($.extend({}, dialogbaseOptions, {\n                open: function() {\n                    var html = menuButtons.getShortcuts(fileManager.currentFile('getEditor'));\n                    aboutDialog.next().find(\"button\").filter(\n                        function() {\n                            return $(this).text() == str('shortcuts');\n                        }\n                  ).button(html != '' ? 'enable' : 'disable');\n                },\n                title: str('about'),\n                width: 400,\n                height: 300,\n                buttons: OKButtons\n            }));\n            aboutDialog.dialog('option', 'height', 300);\n            VPLUtil.setDialogTitleIcon(aboutDialog, 'about');\n\n            var dialogSort = $('#vpl_ide_dialog_sort');\n            var dialogSortButtons = {};\n            dialogSortButtons[str('ok')] = function() {\n                var files = fileManager.getFiles();\n                var regNoNumber = /[^\\d]*/;\n                var sorted = [];\n                var i = 0;\n                var newOrder = $('#vpl_sort_list li');\n                if (newOrder.length != files.length) {\n                    return;\n                }\n                newOrder.each(function() {\n                    var orig = parseInt(this.id.replace(regNoNumber, ''));\n                    sorted.push(files[orig]);\n                });\n                for (i = 0; i < newOrder.length; i++) {\n                    files[i] = sorted[i];\n                }\n                fileManager.setModified();\n                $(this).dialog('close');\n            };\n            dialogSortButtons[str('cancel')] = function() {\n                $(this).dialog('close');\n            };\n            dialogSort.dialog($.extend({}, dialogbaseOptions, {\n                title: str('sort'),\n                buttons: dialogSortButtons,\n                open: function() {\n                    var list = $('#vpl_sort_list');\n                    list.html('');\n                    var files = fileManager.getFiles();\n                    for (var i = 0; i < files.length; i++) {\n                        var file = $('<li id=\"vpl_fsort_' + i + '\"class=\"ui-widget-content\"></li>');\n                        if (i < minNumberOfFiles) {\n                            file.addClass('ui-state-disabled');\n                        }\n                        file.text((i + 1) + '-' + files[i].getFileName());\n                        list.append(file);\n                    }\n                    list.sortable({\n                        items: \"li:not(.ui-state-disabled)\",\n                        placeholder: \"ui-state-highlight\",\n                        start: function(event, ui) {\n                            ui.item.addClass('ui-state-highlight');\n                        },\n                        stop: function(event, ui) {\n                            ui.item.removeClass('ui-state-highlight');\n                        },\n                    });\n                    list.disableSelection();\n                },\n                maxHeight: 400\n            }));\n            VPLUtil.setDialogTitleIcon(dialogSort, 'sort');\n\n            var dialogMultidelete = $('#vpl_ide_dialog_multidelete');\n            var dialogMultideleteButtons = {};\n            dialogMultideleteButtons[str('selectall')] = function() {\n                $(this).find('input').prop(\"checked\", true);\n            };\n            dialogMultideleteButtons[str('deselectall')] = function() {\n                $(this).find('input').prop(\"checked\", false);\n            };\n            dialogMultideleteButtons[str('deleteselected')] = function() {\n                var files = fileManager.getFiles();\n                var toDeleteList = [];\n                var labelList = $('#vpl_multidelete_list label');\n                labelList.each(function() {\n                    var label = $(this);\n                    if (label.find('input').prop('checked')) {\n                        var id = label.data('fileid');\n                        toDeleteList.push(files[id].getFileName());\n                    }\n                });\n                for (var i = 0; i < toDeleteList.length; i++) {\n                    fileManager.deleteFile(toDeleteList[i], showErrorMessage);\n                }\n                VPLUtil.delay('updateMenu', updateMenu);\n                VPLUtil.delay('updateFileList', fileManager.updateFileList);\n                $(this).dialog('close');\n            };\n            dialogMultideleteButtons[str('cancel')] = function() {\n                $(this).dialog('close');\n            };\n            dialogMultidelete.dialog($.extend({}, dialogbaseOptions, {\n                title: str('multidelete'),\n                buttons: dialogMultideleteButtons,\n                open: function() {\n                    var list = $('#vpl_multidelete_list');\n                    list.html('');\n                    var files = fileManager.getFiles();\n                    for (var i = minNumberOfFiles; i < files.length; i++) {\n                        var name = VPLUtil.sanitizeText(files[i].getFileName());\n                        var file = $('<label><input type=\"checkbox\"> ' + name + '</label>');\n                        file.data('fileid', i);\n                        list.append(file);\n                        list.append('<br>');\n                    }\n                    list.find('label').button();\n                },\n                maxHeight: 400,\n                maxWidth: 400\n            }));\n            VPLUtil.setDialogTitleIcon(dialogMultidelete, 'multidelete');\n\n            var dialogFontsize = $('#vpl_ide_dialog_fontsize');\n            var fontsizeSlider = $('#vpl_ide_dialog_fontsize .vpl_fontsize_slider');\n            var dialogFontFizeButtons = {};\n            dialogFontFizeButtons[str('ok')] = function() {\n                var value = fontsizeSlider.slider(\"value\");\n                fileManager.setFontSize(value);\n                $(this).dialog('close');\n                $.ajax({\n                    async: true,\n                    type: \"POST\",\n                    url: '../editor/userpreferences.json.php',\n                    'data': JSON.stringify({fontSize: value}),\n                    contentType: \"application/json; charset=utf-8\",\n                    dataType: \"json\"\n                });\n            };\n            dialogFontFizeButtons[str('cancel')] = function() {\n                fileManager.setFontSize(fontsizeSlider.data(\"vpl_fontsize\"));\n                $(this).dialog('close');\n            };\n            dialogFontFizeButtons[str('reset')] = function() {\n                fontsizeSlider.slider('value', 12);\n            };\n            dialogFontsize.dialog($.extend({}, dialogbaseOptions, {\n                title: str('fontsize'),\n                buttons: dialogFontFizeButtons,\n                open: function() {\n                    fontsizeSlider.data(\"vpl_fontsize\", fileManager.getFontSize());\n                    fontsizeSlider.slider('value', fileManager.getFontSize());\n                },\n            }));\n            fontsizeSlider.slider({\n                min: 1,\n                max: 48,\n                change: function() {\n                    var value = fontsizeSlider.slider(\"value\");\n                    fileManager.setFontSize(value);\n                    dialogFontsize.find('.vpl_fontsize_slider_value').text(value);\n                }\n            });\n            VPLUtil.setDialogTitleIcon(dialogFontsize, 'fontsize');\n\n            var dialogAceTheme = $('#vpl_ide_dialog_acetheme');\n            var acethemeSelect = $('#vpl_ide_dialog_acetheme select');\n            var dialogAceThemeButtons = {};\n            dialogAceThemeButtons[str('ok')] = function() {\n                fileManager.setTheme(acethemeSelect.val());\n                $(this).dialog('close');\n                VPLUtil.setUserPreferences({aceTheme: acethemeSelect.val()});\n            };\n            dialogAceThemeButtons[str('cancel')] = function() {\n                fileManager.setTheme(acethemeSelect.data(\"acetheme\"));\n                $(this).dialog('close');\n            };\n            dialogAceThemeButtons[str('reset')] = function() {\n                acethemeSelect.val(acethemeSelect.data(\"acetheme\"));\n                fileManager.setTheme(acethemeSelect.val());\n            };\n            dialogAceTheme.dialog($.extend({}, dialogbaseOptions, {\n                title: str('theme'),\n                buttons: dialogAceThemeButtons,\n                modal: false,\n                open: function() {\n                    acethemeSelect.data(\"acetheme\", fileManager.getTheme());\n                    acethemeSelect.val(fileManager.getTheme());\n                },\n            }));\n            acethemeSelect.on('change', function() {\n                    $(vpl_results).removeClass();\n                    $(vpl_results).addClass([\"vpl_ide_results\", (acethemeSelect.val() == \"terminal\" ? \"ace-terminal-theme\" : \"ace-\" + (acethemeSelect.val() || 'chrome').replaceAll(\"_\",\"-\"))]);\n                    fileManager.setTheme(acethemeSelect.val());\n            });\n            VPLUtil.setDialogTitleIcon(dialogAceTheme, 'theme');\n\n            var terminal = new VPLTerminal('vpl_dialog_terminal', 'vpl_terminal', str);\n            var VNCClient = new VPLVNCClient('vpl_dialog_vnc', str);\n            var lastConsole = terminal;\n            var fileSelect = $('#vpl_ide_input_file');\n            var fileSelectHandler = function() {\n                VPLUtil.readSelectedFiles(this.files, function(file) {\n                    return fileManager.addFile(file, true, updateMenu, showErrorMessage);\n                },\n                function() {\n                    fileManager.fileListVisibleIfNeeded();\n                });\n            };\n            fileSelect.on('change', fileSelectHandler);\n            // Menu acctions.\n            menuButtons.add({\n                name: 'filelist',\n                originalAction: function() {\n                    fileManager.fileListVisible(!fileManager.isFileListVisible());\n                    VPLUtil.delay('updateMenu', updateMenu);\n                    VPLUtil.delay('autoResizeTab', autoResizeTab);\n                    VPLUtil.delay('updateFileList', fileManager.updateFileList);\n                },\n                bindKey: {\n                    win: 'Ctrl-L',\n                    mac: 'Ctrl-L'\n                }\n            });\n\n            menuButtons.add({\n                name: 'new',\n                originalAction: function() {\n                    if (fileManager.length() < maxNumberOfFiles) {\n                        dialogNew.dialog('open');\n                    }\n                },\n                bindKey: {\n                    win: 'Alt-N',\n                    mac: 'Option-N'\n                }\n            });\n            menuButtons.add({\n                name: 'rename',\n                originalAction: function() {\n                    var file = fileManager.currentFile();\n                    if (file && fileManager.getFilePosById(file.getId()) >= minNumberOfFiles) {\n                        dialogRename.dialog('open');\n                    }\n                },\n                bindKey: {\n                    win: 'Ctrl-R',\n                    mac: 'Ctrl-R'\n                }\n            });\n            menuButtons.add({\n                name: 'delete',\n                originalAction: function() {\n                    var file = fileManager.currentFile();\n                    if (!file) {\n                        return;\n                    }\n                    var filename = file.getFileName();\n                    var message = str('delete_file_fq', filename);\n                    showMessage(message, {\n                        ok: function() {\n                            fileManager.deleteFile(filename, showErrorMessage);\n                        },\n                        title: str('delete_file_q'),\n                        icon: 'trash'\n                    });\n                },\n                bindKey: {\n                    win: 'Ctrl-D',\n                    mac: 'Ctrl-D'\n                }\n            });\n            menuButtons.add({\n                name: 'close',\n                originalAction: function() {\n                    var file = fileManager.currentFile();\n                    if (!file) {\n                        return;\n                    }\n                    fileManager.close(file);\n                },\n                bindKey: {\n                    win: 'Alt-W',\n                    mac: 'Option-W'\n                }\n            });\n            menuButtons.add({\n                name: 'import',\n                originalAction: function() {\n                    fileSelect.val('');\n                    fileSelect.trigger('click');\n                },\n                bindKey: {\n                    win: 'Ctrl-I',\n                    mac: 'Ctrl-I'\n                }\n            });\n            menuButtons.add({\n                name: 'sort',\n                originalAction: function() {\n                    dialogSort.dialog('open');\n                },\n                bindKey: {\n                    win: 'Ctrl-O',\n                    mac: 'Ctrl-O'\n                }\n            });\n            menuButtons.add({\n                name: 'multidelete',\n                originalAction: function() {\n                    dialogMultidelete.dialog('open');\n                }\n            });\n            menuButtons.add({\n                name: 'fontsize',\n                originalAction: function() {\n                    dialogFontsize.dialog('open');\n                }\n            });\n            menuButtons.add({\n                name: 'theme',\n                originalAction: function() {\n                    dialogAceTheme.dialog('open');\n                }\n            });\n            menuButtons.add({\n                name: 'print',\n                originalAction: function() {\n                    window.print();\n                },\n                bindKey: {\n                    win: 'Alt-P',\n                    mac: 'Command-P'\n                }\n            });\n            menuButtons.add({\n                name: 'undo',\n                originalAction: function() {\n                    fileManager.currentFile('undo');\n                }\n            });\n            menuButtons.add({\n                name: 'redo',\n                originalAction: function() {\n                    fileManager.currentFile('redo');\n                }\n            });\n            menuButtons.add({\n                name: 'select_all',\n                editorName: 'selectall',\n                originalAction: function() {\n                    fileManager.currentFile('selectAll');\n                }\n            });\n            menuButtons.add({\n                name: 'find',\n                originalAction: function() {\n                    fileManager.currentFile('find');\n                }\n            });\n            menuButtons.add({\n                name: 'find_replace',\n                editorName: 'replace',\n                originalAction: function() {\n                    fileManager.currentFile('replace');\n                }\n            });\n            menuButtons.add({\n                name: 'next',\n                editorName: 'findnext',\n                originalAction: function() {\n                    fileManager.currentFile('next');\n                }\n            });\n            menuButtons.add({\n                name: 'fullscreen',\n                originalAction: function() {\n                    var tags = 'header, nav, footer, aside, .dropdown, #page-header, div.navbar, #nav-drawer';\n                    tags += ', div.tabtree, #dock, .breadcrumb-nav, .moodle-actionmenu';\n                    if (fullScreen) {\n                        rootObj.removeClass('vpl_ide_root_fullscreen');\n                        $('body').removeClass('vpl_body_fullscreen');\n                        menuButtons.setText('fullscreen', 'fullscreen');\n                        $(tags).show();\n                        $('#vpl_ide_user').hide();\n                        fullScreen = false;\n                    } else {\n                        $('body').addClass('vpl_body_fullscreen').scrollTop(0);\n                        $(tags).hide();\n                        rootObj.addClass('vpl_ide_root_fullscreen');\n                        menuButtons.setText('fullscreen', 'regularscreen');\n                        if (options.username) {\n                            $('#vpl_ide_user').show();\n                        }\n                        fullScreen = true;\n                    }\n                    focusCurrentFile();\n                    setTimeout(autoResizeTab, 10);\n                },\n                bindKey: {\n                    win: 'Alt-F',\n                    mac: 'Ctrl-F'\n                }\n            });\n            menuButtons.add({\n                name: 'download',\n                originalAction: function() {\n                    window.location = options.download;\n                }\n            });\n            /**\n             * Reset files action\n             */\n            function resetFiles() {\n                VPLUtil.requestAction('resetfiles', '', {}, options.ajaxurl)\n                .done(function(response) {\n                    var files = response.files;\n                    for (var fileName in files) {\n                        if (files.hasOwnProperty(fileName)) {\n                            fileManager.addFile(files[fileName], true, VPLUtil.doNothing, showErrorMessage);\n                        }\n                    }\n                    fileManager.fileListVisibleIfNeeded();\n                    VPLUtil.delay('updateMenu', updateMenu);\n                }).fail(showErrorMessage);\n            }\n            menuButtons.add({\n                name: 'resetfiles',\n                originalAction: function() {\n                    showMessage(str('sureresetfiles'), {\n                        title: str('resetfiles'),\n                        ok: resetFiles,\n                        icon: 'resetfiles'\n                    });\n                }\n            });\n            menuButtons.add({\n                name: 'save',\n                originalAction: function() {\n                    var data = {\n                        files: fileManager.getFilesToSave(),\n                        comments: $('#vpl_ide_input_comments').val(),\n                        version: fileManager.getVersion()\n                    };\n                    if (JSON.stringify(data).length > options.postMaxSize) {\n                        showErrorMessage(str('maxpostsizeexceeded'));\n                        return;\n                    }\n                    /**\n                     * Save action\n                     */\n                    function doSave() {\n                        const reg = /^lang_[^_]+_[^_]+\\.json$/;\n                        let langConfigParseError = false;\n                        for (let i = 0; i < data.files.length; i++){\n                            file = data.files[i];                        \n                            if (reg.test(file.name)){\n                                try {\n                                    JSON.parse(file.contents);\n                                } catch (e) {\n                                    if (e instanceof SyntaxError){\n                                        langConfigParseError = true;\n                                        showErrorMessage(`Enhance configuration file ${file.name} with parse error`);\n                                        break;\n                                    } else {\n                                        throw e;\n                                    }\n                                }\n                            }\n                        }\n                        if (!langConfigParseError){\n                            VPLUtil.requestAction('save', 'saving', data, options.ajaxurl)\n                            .done(function(response) {\n                                if (response.requestsconfirmation) {\n                                    showMessage(response.question, {\n                                        title: str('saving'),\n                                        icon: 'alert',\n                                        yes: function() {\n                                            data.version = 0;\n                                            doSave();\n                                        }\n                                    });\n                                } else {\n                                    fileManager.resetModified();\n                                    fileManager.setVersion(response.version);\n                                    menuButtons.setTimeLeft(response);\n                                    VPLUtil.delay('updateMenu', updateMenu);\n                                    if (VPLUtil.monitorRunning()) {\n                                        data.processid = VPLUtil.getProcessId();\n                                        VPLUtil.requestAction('update', 'updating', data, options.ajaxurl);\n                                    }\n                                }\n                            }).fail(showErrorMessage);\n                        }\n                    }\n                    doSave();\n                },\n                bindKey: {\n                    win: 'Ctrl-S',\n                    mac: 'Command-S'\n                }\n            });\n\n            /**\n             * Launches the action\n             *\n             * @param {string} action Action 'run', 'debug', 'evaluate'\n             * @param {string} acting I18n for the action in progress\n             * @param {string} data Data attached to the action\n             */\n            function executionRequest(action, acting, data) {\n                if (!data) {\n                    data = {};\n                }\n                if (!lastConsole.isConnected()) {\n                    VPLUtil.requestAction(action, '', data, options.ajaxurl)\n                    .done(function(response) {\n                        VPLUtil.webSocketMonitor(response, action, acting, executionActions);\n                    })\n                    .fail(showErrorMessage);\n                }\n            }\n            /**\n             * Launches the run action\n             */\n            function runAction() {\n                executionRequest('run', 'running', {\n                    XGEOMETRY: VNCClient.getCanvasSize()\n                });\n            }\n            menuButtons.add({\n                name: 'run',\n                originalAction: function() {\n                    executionActions.setLastAction(runAction);\n                    runAction();\n                },\n                bindKey: {\n                    win: 'Ctrl-F11',\n                    mac: 'Command-U'\n                }\n            });\n            /**\n             * Launches the debug action\n             */\n            function debugAction() {\n                executionRequest('debug', 'debugging', {\n                    XGEOMETRY: VNCClient.getCanvasSize()\n                });\n            }\n            menuButtons.add({\n                name: 'debug',\n                originalAction: function() {\n                    executionActions.setLastAction(debugAction);\n                    debugAction();\n                },\n                bindKey: {\n                    win: 'Alt-F11',\n                    mac: 'Option-U'\n                }\n            });\n            /**\n             * Launches the evaluate action\n             */\n            function evaluateAction() {\n                executionRequest('evaluate', 'evaluating');\n            }\n            menuButtons.add({\n                name: 'evaluate',\n                originalAction: function() {\n                    executionActions.setLastAction(evaluateAction);\n                    evaluateAction();\n                },\n                bindKey: {\n                    win: 'Shift-F11',\n                    mac: 'Command-Option-U'\n                }\n            });\n            menuButtons.add({\n                name: 'comments',\n                originalAction: function() {\n                    dialogComments.dialog('open');\n                },\n            });\n            menuButtons.add({\n                name: 'console',\n                originalAction: function() {\n                    if (lastConsole.isOpen()) {\n                        lastConsole.close();\n                    } else {\n                        lastConsole.show();\n                    }\n                }\n            });\n            menuButtons.add({name: 'user'});\n            menuButtons.add({\n                name: 'about',\n                originalAction: function() {\n                    aboutDialog.dialog('open');\n                }\n            });\n            menuButtons.add({\n                name: 'timeleft',\n                originalAction: function() {\n                    menuButtons.toggleTimeLeft();\n                }\n            });\n            menuButtons.add({\n                name: 'more',\n                originalAction: function() {\n                    var tag = $('#vpl_ide_menuextra');\n                    if (tag.is(\":visible\")) {\n                        menuButtons.setText('more', 'more', VPLUtil.str('more'));\n                        tag.hide();\n                    } else {\n                        menuButtons.setText('more', 'less', VPLUtil.str('less'));\n                        tag.show();\n                    }\n                    VPLUtil.delay('updateMenu', updateMenu);\n                    VPLUtil.delay('autoResizeTab', autoResizeTab);\n                }\n            });\n            menuButtons.add({\n                name: 'rightpanel',\n                icon: 'close-rightpanel',\n                originalAction: function() {\n                    if (resultContainer.vplVisible) {\n                        resultContainer.hide();\n                        resultContainer.vplVisible = false;\n                        menuButtons.setText('rightpanel', 'open-rightpanel', VPLUtil.str('rightpanel'));\n                    } else {\n                        menuButtons.setText('rightpanel', 'close-rightpanel', VPLUtil.str('rightpanel'));\n                        resultContainer.show();\n                        resultContainer.vplVisible = true;\n                    }\n                    VPLUtil.delay('autoResizeTab', autoResizeTab);\n                },\n                bindKey: {\n                    win: 'Ctrl-M',\n                    mac: 'Ctrl-M'\n                }\n            });\n            var rightpanelstyle = \"position:absolute;right:0;top:60px;z-index:100;margin:3px\";\n            tr.append('<span style=\"' + rightpanelstyle + '\">' + menuButtons.getHTML('rightpanel') + '</span>');\n            var rightPanelButton = $('#vpl_ide_rightpanel');\n            menuButtons.setText('rightpanel', 'close-rightpanel', VPLUtil.str('rightpanel'));\n\n            rightPanelButton.button();\n            rightPanelButton.css('padding', '0');\n            $('#vpl_ide_rightpanel.ui-button-text').css('padding', '0');\n            rightPanelButton.on('click', function() {\n                menuButtons.launchAction('rightpanel');\n            });\n            rightPanelButton.hide();\n            menu.addClass(\"ui-widget-header ui-corner-all\");\n            var menuHtml = \"\";\n            menuHtml += menuButtons.getHTML('more');\n            menuHtml += menuButtons.getHTML('save');\n            menuHtml += \"<span id='vpl_ide_mexecution'>\";\n            menuHtml += menuButtons.getHTML('run');\n            menuHtml += menuButtons.getHTML('debug');\n            menuHtml += menuButtons.getHTML('evaluate');\n            menuHtml += menuButtons.getHTML('comments');\n            menuHtml += menuButtons.getHTML('console');\n            menuHtml += \"</span> \";\n            menuHtml += \"<span id='vpl_ide_menuextra'>\";\n            menuHtml += \"<span id='vpl_ide_file'>\";\n            // TODO autosave not implemented.\n            menuHtml += menuButtons.getHTML('filelist');\n            menuHtml += menuButtons.getHTML('new');\n            menuHtml += menuButtons.getHTML('rename');\n            menuHtml += menuButtons.getHTML('delete');\n            menuHtml += menuButtons.getHTML('import');\n            menuHtml += menuButtons.getHTML('download');\n            menuHtml += menuButtons.getHTML('resetfiles');\n            menuHtml += menuButtons.getHTML('sort');\n            menuHtml += menuButtons.getHTML('multidelete');\n            menuHtml += menuButtons.getHTML('fontsize');\n            menuHtml += menuButtons.getHTML('theme');\n            menuHtml += \"</span> \";\n            // TODO print still not implemented.\n            menuHtml += \"<span id='vpl_ide_edit'>\";\n            menuHtml += menuButtons.getHTML('undo');\n            menuHtml += menuButtons.getHTML('redo');\n            menuHtml += menuButtons.getHTML('select_all');\n            menuHtml += menuButtons.getHTML('find');\n            menuHtml += menuButtons.getHTML('find_replace');\n            menuHtml += menuButtons.getHTML('next');\n            menuHtml += \"</span> \";\n            menuHtml += \"</span> \";\n            menuHtml += menuButtons.getHTML('fullscreen') + ' ';\n            menuHtml += menuButtons.getHTML('about') + ' ';\n            menuHtml += menuButtons.getHTML('user') + ' ';\n            menuHtml += menuButtons.getHTML('timeleft');\n            menuHtml += '<div class=\"clearfix\"></div>';\n            menu.append(menuHtml);\n            $('#vpl_ide_more').button();\n            $('#vpl_ide_save').button();\n            $('#vpl_ide_menuextra').hide();\n            $('#vpl_ide_file').controlgroup();\n            $('#vpl_ide_edit').controlgroup();\n            $('#vpl_ide_mexecution').controlgroup();\n            $('#vpl_ide_fullscreen').button();\n            $('#vpl_ide_acetheme').button();\n            $('#vpl_ide_about').button();\n            $('#vpl_ide_user').button().css('float', 'right').hide();\n            $('#vpl_ide_timeleft').button().css('float', 'right').hide();\n            $('#vpl_menu .ui-button').css('padding', '6px');\n            $('#vpl_menu .ui-button-text').css('padding', '0');\n            var alwaysActive = ['filelist', 'more', 'fullscreen', 'about', 'resetfiles',\n                                'download', 'comments', 'console', 'import',\n                                'fontsize', 'timeleft'];\n            for (var i = 0; i < alwaysActive.length; i++) {\n                menuButtons.enable(alwaysActive[i], true);\n            }\n            menuButtons.setExtracontent('user', options.username);\n            menuButtons.setTimeLeft(options);\n            updateMenu = function() {\n                var i;\n                var file = fileManager.currentFile();\n                var nfiles = fileManager.length();\n                if (nfiles) {\n                    tabs.show();\n                } else {\n                    tabs.hide();\n                }\n                if (fileManager.isFileListVisible()) {\n                    menuButtons.setText('filelist', 'filelistclose', VPLUtil.str('filelist'));\n                } else {\n                    menuButtons.setText('filelist', 'filelist', VPLUtil.str('filelist'));\n                }\n                var modified = fileManager.isModified();\n                menuButtons.enable('save', modified);\n                var running = VPLUtil.monitorRunning();\n                if (running) {\n                    menuButtons.setText('run', 'running');\n                } else {\n                    menuButtons.setText('run', 'run');\n                }\n                menuButtons.enable('run', !running && (!modified || options.example) && isOptionAllowed('run'));\n                menuButtons.enable('debug', !running && (!modified || options.example) && isOptionAllowed('debug'));\n                menuButtons.enable('evaluate', !running && (!modified || options.example) && isOptionAllowed('evaluate'));\n                menuButtons.enable('download', !modified);\n                menuButtons.enable('new', nfiles < maxNumberOfFiles);\n                menuButtons.enable('sort', nfiles - minNumberOfFiles > 1);\n                menuButtons.enable('multidelete', nfiles - minNumberOfFiles > 1);\n                menuButtons.enable('theme', true);\n                var sel;\n                if (!file || nfiles === 0) {\n                    sel = ['rename', 'delete', 'undo', 'redo', 'select_all', 'find', 'find_replace', 'next'];\n                    for (i = 0; i < sel.length; i++) {\n                        menuButtons.enable(sel[i], false);\n                    }\n                    return;\n                }\n                var id = fileManager.getFilePosById(file.getId());\n                menuButtons.enable('rename', id >= minNumberOfFiles && nfiles !== 0);\n                menuButtons.enable('delete', id >= minNumberOfFiles && nfiles !== 0);\n                menuButtons.enable('undo', file.hasUndo());\n                menuButtons.enable('redo', file.hasRedo());\n                menuButtons.enable('select_all', file.hasSelectAll());\n                menuButtons.enable('find', file.hasFind());\n                menuButtons.enable('find_replace', file.hasFindReplace());\n                menuButtons.enable('next', file.hasNext());\n                VPLUtil.delay('updateFileList', fileManager.updateFileList);\n            };\n\n            executionActions = {\n                'open': updateMenu,\n                'close': updateMenu,\n                'getConsole': function() {\n                    return lastConsole;\n                },\n                'setResult': self.setResult,\n                'ajaxurl': options.ajaxurl,\n                'run': function(content, coninfo, ws) {\n                    var parsed = /^([^:]*):?(.*)/i.exec(content);\n                    var type = parsed[1];\n                    if (type == 'terminal' || type == 'webterminal') {\n                        if (lastConsole && lastConsole.isOpen()) {\n                            lastConsole.close();\n                        }\n                        lastConsole = terminal;\n                        terminal.connect(coninfo.executionURL, function() {\n                            ws.close();\n                            focusCurrentFile();\n                        });\n                        if (type == 'webterminal') {\n                            var URLfavicon = (coninfo.secure ? \"https\" : \"http\") + \"://\" + coninfo.server + \":\" + coninfo.portToUse;\n                            URLfavicon += \"/favicon.ico\";\n                            var imgFavicon = $('<img>');\n                            imgFavicon.attr('src', URLfavicon);\n                            imgFavicon.attr('style', 'display:none');\n                            $('body').append(imgFavicon);\n                        }\n                    } else if (type == 'vnc') {\n                        if (lastConsole && lastConsole.isOpen()) {\n                            lastConsole.close();\n                        }\n                        lastConsole = VNCClient;\n                        VNCClient.connect(coninfo.secure, coninfo.server, coninfo.portToUse, coninfo.VNCpassword,\n                                coninfo.executionPath, function() {\n                                    ws.close();\n                                    focusCurrentFile();\n                                });\n                    } else if (type == \"browser\") {\n                        var URL = (coninfo.secure ? \"https\" : \"http\") + \"://\" + coninfo.server + \":\" + coninfo.portToUse + \"/\";\n                        URL += parsed[2] + \"/httpPassthrough\";\n                        if (isTeacher) {\n                            URL += \"?private\";\n                        }\n                        var message = '<a href=\"' + URL + '\" target=\"_blank\">';\n                        message += VPLUtil.str('open') + '</a>';\n                        var options = {\n                            width: 200,\n                            icon: 'run',\n                            title: VPLUtil.str('run'),\n                        };\n                        showMessage(message, options);\n                    } else {\n                        VPLUtil.log(\"Type of run error \" + content, true);\n                    }\n                },\n                'lastAction': false,\n                'getLastAction': function() {\n                    var ret = this.lastAction;\n                    this.lastAction = false;\n                    return ret;\n                },\n                'setLastAction': function(action) {\n                    this.lastAction = action;\n                }\n            };\n\n            tabs.on(\"tabsactivate\", function() {\n                fileManager.currentFile('focus');\n                VPLUtil.delay('updateMenu', updateMenu);\n                VPLUtil.delay('autoResizeTab', autoResizeTab);\n            });\n\n            // VPLIDE resize view control.\n            var jw = $(window);\n            jw.on('resize', autoResizeTab);\n            // Save? before exit.\n            if (!options.example) {\n                jw.on('beforeunload', function() {\n                    if (fileManager.isModified()) {\n                        return str('changesNotSaved');\n                    }\n                    return undefined;\n                });\n            }\n            fileManager = new FileManager();\n\n            autoResizeTab();\n            // Checks menu width every 1 sec as it can change without event.\n            (function() {\n                var oldMenuWidth = menu.width();\n                /**\n                 * Checks menu width change\n                 */\n                function checkMenuWidth() {\n                    var newMenuWidth = menu.width();\n                    if (oldMenuWidth != newMenuWidth) {\n                        oldMenuWidth = newMenuWidth;\n                        autoResizeTab();\n                    }\n                }\n                checkMenuWidth();\n                setInterval(checkMenuWidth, 1000);\n            }());\n            fileManager.resetModified();\n            VPLUtil.requestAction('load', 'loading', options, options.loadajaxurl)\n            .done(function(response) {\n                var allOK = true;\n                var files = response.files;\n                var showFileList = false;\n                for (var i = 0; i < files.length; i++) {\n                    var file = files[i];\n                    var r = fileManager.addFile(file, false, updateMenu, showErrorMessage);\n                    if (r) {\n                        r.resetModified();\n                        if (i < minNumberOfFiles || files.length <= 5) {\n                            fileManager.open(r);\n                        } else {\n                            showFileList = true;\n                        }\n                    } else {\n                        allOK = false;\n                    }\n                }\n                tabs.tabs('option', 'active', 0);\n\n                if (response.compilationexecution) {\n                    self.setResult(response.compilationexecution, false);\n                }\n                menuButtons.setTimeLeft(response);\n                if (response.comments > '') {\n                    $('#vpl_ide_input_comments').val(response.comments);\n                }\n                if (allOK) {\n                    fileManager.resetModified();\n                } else {\n                    fileManager.setModified();\n                }\n                if (fileManager.length() === 0 && maxNumberOfFiles > 0) {\n                    menuButtons.getAction('new')();\n                } else if (!options.saved) {\n                    fileManager.setModified();\n                }\n                fileManager.setFontSize(options.fontSize);\n                fileManager.setVersion(response.version);\n                fileManager.fileListVisible(showFileList);\n                VPLUtil.afterAll('AfterLoadFiles', function() {\n                    updateMenu();\n                    autoResizeTab();\n                    adjustTabsTitles(true);\n                });\n            })\n            .fail(showErrorMessage);\n        };\n        window.VPLIDE = VPLIDE;\n        return {\n            init: function(rootId, options) {\n                vplIdeInstance = new VPLIDE(rootId, options);\n            }\n        };\n    }\n);\n"],"mappings":"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"}