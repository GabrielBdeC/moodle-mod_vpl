{"version":3,"file":"vplterminal.min.js","names":["define","$","jqui","VPLUtil","VPLClipboard","VPLTerminal","dialogId","terminalId","str","receiveClipboard","data","clipboardData","length","from","substr","pasteClipboard","ws","readyState","OPEN","send","clipboard","getEntry2","updateClipboard","setEntry1","openClipboard","show","setTheme","theme","cbase","nthemes","tdialog","setUserPreferences","terminalTheme","i","removeClass","addClass","controlDialogSize","bw","tIde","width","bh","height","dialog","parent","prev","outerHeight","terminal","self","onCloseAction","doNothing","title","message","titleText","terminalTag","updateTitle","text","setTitle","t","setMessage","write","connect","server","onClose","window","reset","startBlink","close","WebSocket","writeBuffer","writeIt","onmessage","event","setTimeout","onopen","onclose","blur","stopBlink","stopOutput","writeLocal","setDataCallback","call","onData","closeLocal","connectLocal","readBuffer","pos","indexOf","isOpen","isConnected","CLOSED","disconnect","HTMLUpdateClipboard","genIcon","HTMLPaste","document","execCommand","closeDialog","hide","closeOnEscape","autoOpen","resizable","dragStop","open","focus","dialogClass","create","setTitleBar","resizeStop","setFontSize","size","css","getUserPreferences","preferences","init","Terminal","loadScript","cols","rows","useStyle","screenKeys","on","setLineCallback","line","nlines","offset","scrollTop","viewHeight","innerHeight","lineHeight"],"sources":["../src/vplterminal.js"],"sourcesContent":["// This file is part of VPL for Moodle - http://vpl.dis.ulpgc.es/\n//\n// VPL for Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// VPL for Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with VPL for Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Terminal control\n *\n * @copyright 2014 Juan Carlos Rodríguez-del-Pino\n * @license http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n * @author Juan Carlos Rodríguez-del-Pino <jcrodriguez@dis.ulpgc.es>\n */\n\n/* globals Terminal */\n\ndefine(\n    [\n        'jquery',\n        'jqueryui',\n        'mod_vpl/vplutil',\n        'mod_vpl/vplclipboard'\n    ],\n    function($, jqui, VPLUtil, VPLClipboard) {\n        if (typeof VPLTerminal !== 'undefined') {\n            return VPLTerminal;\n        }\n        var NTHEMES = 5;\n        var VPLTerminal = function(dialogId, terminalId, str) {\n            var self = this;\n            var ws = null;\n            var onCloseAction = VPLUtil.doNothing;\n            var title = '';\n            var message = '';\n            var tdialog = $('#' + dialogId);\n            var tIde = $('#vplide');\n            var titleText = '';\n            var clipboard = null;\n            var cliboardMaxsize = 64000;\n            var clipboardData = '';\n\n            var terminal;\n            var terminalTag = $('#' + terminalId);\n            this.updateTitle = function() {\n                var text = title;\n                if (message !== '') {\n                    text += ' (' + message + ')';\n                }\n                titleText.text(str('console') + \": \" + text);\n            };\n            this.setTitle = function(t) {\n                title = t;\n                this.updateTitle();\n            };\n            this.setMessage = function(t) {\n                message = t;\n                this.updateTitle();\n            };\n            /**\n             * Manages the data received from clipboard\n             * @param {string} data Data recieved\n             */\n            function receiveClipboard(data) {\n                clipboardData += data;\n                if (clipboardData.length > cliboardMaxsize) {\n                    var from = clipboardData.length - cliboardMaxsize / 2;\n                    clipboardData = clipboardData.substr(from);\n                }\n            }\n            /**\n             * Sends the clipboard data to the connection\n             */\n            function pasteClipboard() {\n                if (ws && ws.readyState == ws.OPEN) {\n                    ws.send(clipboard.getEntry2());\n                }\n            }\n            /**\n             * Updates the data in the clipboard dialog\n             */\n            function updateClipboard() {\n                clipboard.setEntry1(clipboardData);\n            }\n            /**\n             * Opens the clipboard dialog\n             */\n            function openClipboard() {\n                updateClipboard();\n                clipboard.show();\n            }\n            this.write = function(text) {\n                terminal.write(text);\n                return text;\n            };\n\n            this.connect = function(server, onClose) {\n                onCloseAction = onClose;\n                if (\"WebSocket\" in window) {\n                    terminal.reset();\n                    terminal.startBlink();\n                    self.show();\n                    if (ws) {\n                        ws.close();\n                    }\n                    clipboardData = '';\n                    self.setMessage('');\n                    self.setTitle(str('connecting'));\n                    ws = new WebSocket(server);\n                    ws.writeBuffer = '';\n                    ws.writeIt = function() {\n                        terminal.write(ws.writeBuffer);\n                        receiveClipboard(ws.writeBuffer);\n                        ws.writeBuffer = '';\n                    };\n                    ws.onmessage = function(event) {\n                        if (ws.writeBuffer.length > 0) {\n                            ws.writeBuffer += event.data;\n                        } else {\n                            ws.writeBuffer = event.data;\n                            setTimeout(ws.writeIt, 35);\n                        }\n                    };\n                    ws.onopen = function() {\n                        self.setMessage('');\n                        self.setTitle(str('connected'));\n                    };\n                    ws.onclose = function() {\n                        self.setTitle(str('connection_closed'));\n                        terminal.blur();\n                        terminal.stopBlink();\n                        onClose();\n                        ws.stopOutput = true;\n                    };\n                } else {\n                    terminal.write('WebSocket not available: Upgrade your browser');\n                }\n            };\n            this.writeLocal = function(text) {\n                ws.onmessage({\n                    data: text\n                });\n                return text;\n            };\n            this.setDataCallback = function(call) {\n                ws.onData = call;\n            };\n            this.closeLocal = function() {\n                if (ws) {\n                    ws.writeIt();\n                    ws.close();\n                    terminal.stopBlink();\n                    self.setTitle(str('connection_closed'));\n                }\n            };\n            this.connectLocal = function(onClose, onData) {\n                onCloseAction = onClose;\n                terminal.reset();\n                terminal.startBlink();\n                self.show();\n                if (ws) {\n                    ws.close();\n                }\n                clipboardData = '';\n                self.setMessage('');\n                self.setTitle(str('running'));\n                ws = {};\n                ws.onData = onData;\n                ws.writeBuffer = '';\n                ws.readBuffer = '';\n                ws.readyState = 1;\n                ws.OPEN = 1;\n                ws.close = function() {\n                    ws = false;\n                };\n                ws.onmessage = function(event) {\n                    ws.writeBuffer = event.data;\n                    ws.writeIt();\n                };\n                ws.writeIt = function() {\n                    if (ws) {\n                        terminal.write(ws.writeBuffer);\n                        receiveClipboard(ws.writeBuffer);\n                        ws.writeBuffer = '';\n                    }\n                };\n                ws.send = function(text) {\n                    // Process backspace.\n                    if (text == '\\u007f') {\n                        if (ws.readBuffer.length > 0) {\n                            self.writeLocal('\\b \\b');\n                            ws.readBuffer = ws.readBuffer.substr(0, ws.readBuffer.length - 1);\n                        }\n                    } else {\n                        self.writeLocal(text);\n                        ws.readBuffer += text;\n                    }\n                    var pos = ws.readBuffer.indexOf(\"\\r\");\n                    if (pos != -1) {\n                        var data = ws.readBuffer.substr(0, pos);\n                        ws.readBuffer = ws.readBuffer.substr(pos + 1);\n                        ws.onData(data);\n                    }\n                };\n            };\n            this.isOpen = function() {\n                return tdialog.dialog(\"isOpen\");\n            };\n            this.close = function() {\n                tdialog.dialog(\"close\");\n            };\n            this.isConnected = function() {\n                return ws && ws.readyState != ws.CLOSED;\n            };\n            this.disconnect = function() {\n                if (ws && ws.readyState == ws.OPEN) {\n                    onCloseAction();\n                    if (ws) {\n                        ws.close();\n                    }\n                    terminal.stopBlink();\n                }\n            };\n            var HTMLUpdateClipboard = VPLUtil.genIcon('copy', 'sw') + ' ' + str('copy');\n            var HTMLPaste = VPLUtil.genIcon('paste', 'sw') + ' ' + str('paste');\n            clipboard = new VPLClipboard('vpl_dialog_terminal_clipboard', HTMLUpdateClipboard, function() {\n                    updateClipboard();\n                    document.execCommand('copy');\n                }, HTMLPaste, pasteClipboard);\n            this.closeDialog = function() {\n                clipboard.hide();\n                self.disconnect();\n            };\n            /**\n             * Sets the terminal theme\n             * @param {int} theme\n             */\n            function setTheme(theme) {\n                var cbase = \"vpl_terminal_theme\";\n                var nthemes = 5;\n                tdialog.data('terminal_theme', theme);\n                VPLUtil.setUserPreferences({terminalTheme: theme});\n                for (var i = 0; i < nthemes; i++) {\n                    tdialog.removeClass(cbase + i);\n                }\n                tdialog.addClass(cbase + theme);\n            }\n            /**\n             * Limits the size of the dialogo to the IDE\n             */\n            function controlDialogSize() {\n                // Resize if dialog is large than screen.\n                var bw = tIde.width();\n                var bh = tIde.height();\n                if (tdialog.width() > bw) {\n                    tdialog.dialog(\"option\", \"width\", bw);\n                }\n                if (tdialog.parent().height() > bh) {\n                    tdialog.dialog(\"option\", \"height\", bh - tdialog.prev().outerHeight());\n                }\n            }\n            tdialog.dialog({\n                closeOnEscape: false,\n                autoOpen: false,\n                width: 'auto',\n                height: 'auto',\n                resizable: true,\n                dragStop: controlDialogSize,\n                open: controlDialogSize,\n                focus: function() {\n                    controlDialogSize();\n                    terminal.focus();\n                },\n                dialogClass: 'vpl_ide vpl_vnc',\n                create: function() {\n                    titleText = VPLUtil.setTitleBar(tdialog, 'console', 'console',\n                            ['clipboard', 'keyboard', 'theme'],\n                            [openClipboard,\n                            function() {\n                                terminal.focus();\n                            },\n                            function() {\n                                // Cycle themes from 0 to NTHEMES-1.\n                                var theme = (tdialog.data('terminal_theme') + 1) % NTHEMES;\n                                setTheme(theme);\n                            }]);\n                },\n                close: function() {\n                    self.closeDialog();\n                },\n                resizeStop: function() {\n                    tdialog.width(tdialog.parent().width());\n                    tdialog.height(tdialog.parent().height() - tdialog.prev().outerHeight());\n                    controlDialogSize();\n                    terminal.focus();\n                }\n            });\n            this.setFontSize = function(size) {\n                terminalTag.css(\"font-size\", size + \"px\");\n            };\n            VPLUtil.getUserPreferences(function(data) {\n                setTheme(data.preferences.terminalTheme);\n            });\n            tdialog.css(\"padding\", \"1px\");\n            tdialog.parent().css('z-index', 2000);\n            this.show = function() {\n                tdialog.dialog('open');\n                terminal.focus();\n            };\n            this.init = function() {\n                if (typeof Terminal === 'undefined') {\n                    VPLUtil.loadScript(['../../vpl/editor/xterm/term.js'], function() {\n                                                                               self.init();\n                                                                           });\n                    return;\n                }\n                terminal = new Terminal({\n                    cols: 80,\n                    rows: 24,\n                    useStyle: true,\n                    screenKeys: true\n                });\n                terminal.on('data', function(data) {\n                    if (ws && ws.readyState == ws.OPEN) {\n                        ws.send(data);\n                    }\n                });\n                terminal.open(terminalTag[0]);\n                terminal.reset();\n                terminal.stopBlink();\n                terminal.setLineCallback(\n                    function(line, nlines) {\n                        var height = terminalTag.height();\n                        var offset = tdialog.scrollTop();\n                        var viewHeight = tdialog.innerHeight();\n                        if (viewHeight >= height) {\n                            return;\n                        }\n                        var lineHeight = height / nlines;\n                        var pos = line * lineHeight;\n                        // If cursor in view area return.\n                        if (pos >= offset && pos < (viewHeight + offset - lineHeight)) {\n                            return;\n                        }\n                        if (pos < offset) { // If cursor beforer view area scroll to first view line.\n                            tdialog.scrollTop(pos);\n                        } else {\n                            tdialog.scrollTop((pos - viewHeight) + 2 * lineHeight);\n                        }\n                    }\n                );\n            };\n            this.init();\n        };\n        window.VPLTerminal = VPLTerminal;\n        return VPLTerminal;\n    }\n);\n"],"mappings":"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"}