function enhancedMouseMove(e,t){var s=document.getElementById("enhancedPop"+t);"block"==s.style.display&&(s.style.left=e.clientX+"px",s.style.top=e.clientY+"px")}function enhancedMouseOver(e,t){document.getElementById("enhancedPop"+t).style.display="block"}function enhancedMouseOut(e,t){document.getElementById("enhancedPop"+t).style.display="none"}define(["jquery","jqueryui","core/log"],function(s,e,t){var a={doNothing:s.noop,returnFalse:function(){return!1},returnTrue:function(){return!0}},o=!1;return a.log=function(e,s){(o||s)&&t.debug(e)},a.setUserPreferences=function(e){s.ajax({async:!0,type:"POST",url:"../editor/userpreferences.json.php",data:JSON.stringify(e),contentType:"application/json; charset=utf-8",dataType:"json"})},a.getUserPreferences=function(e){s.ajax({async:!0,type:"POST",url:"../editor/userpreferences.json.php",data:JSON.stringify({getPreferences:!0}),contentType:"application/json; charset=utf-8",dataType:"json"}).done(t=>{vpl_global_lang=t.preferences.lang,e(t)})},a.scrollBarWidth=function(){var e,t,n;return e=s("<div style=\"width:50px;height:50px;overflow:auto\"><div/></div>").appendTo("body"),t=e.children(),n=t.innerWidth()-t.height(99).innerWidth(),e.remove(),n},a.sanitizeHTML=function(e){return"undefined"==typeof e||""==e.replace(/^\s+$/g,"")?"":s("<div>"+e+"</div>").html()},a.sanitizeText=function(e){return"undefined"==typeof e||""==e.replace(/^\s+$/g,"")?"":e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},a.setProtocol=function(e){var t;if(0==e.securePort||0==e.port)t=0==e.port;else switch(e.wsProtocol){case"always_use_wss":t=!0;break;case"always_use_ws":t=!1;break;default:t="https:"==window.location.protocol;}var s=(t?"wss://":"ws://")+e.server;e.secure=t,e.portToUse=t?e.securePort:e.port,s+=":"+e.portToUse+"/",e.monitorURL=s+e.monitorPath,e.executionURL=s+e.executionPath},a.ArrayBuffer2String=function(e){var t,s,n=new Uint8Array(e),a=[],o=32e3;for(t=0,s=n.length;t<s;t+=o)a.push(String.fromCharCode.apply(String,n.subarray(t,Math.min(t+o,s))));return a.join("")},a.String2ArrayBuffer=function(e){for(var t=e.length,s=new ArrayBuffer(t),n=new Uint8Array(s),a=0;a<t;a++)n[a]=e.charCodeAt(a);return s},function(){var e=0;a.getUniqueId=function(){return e++}}(),function(){var e=/\.([^.]*)$/,t=/^(gif|jpg|jpeg|png|ico)$/i,s=/^(zip|jar|pdf|tar|bin|7z|arj|deb|gzip|rar|rpm|dat|db|dll|rtf|doc|docx|odt|exe|com)$/i,n=/^blockly[0123]?$/;a.fileExtension=function(t){var s=e.exec(t);return null===s?"":s[1]},a.isImage=function(e){return t.test(a.fileExtension(e))},a.isBinary=function(e){return a.isImage(e)||s.test(a.fileExtension(e))},a.isBlockly=function(e){return n.test(a.fileExtension(e))};var i=/[\cA-\cZ]|[:-@]|[{-~]|\\|\[|\]|[/^`Â´]|^-|^ | $|\.\./;a.validFileName=function(e){return!(1>e.length)&&!(128<e.length)&&!i.test(e)}}(),a.getCurrentTime=function(){return parseInt(new Date().valueOf()/1e3)},a.encodeBinary=function(e,t){return a.isBinary(e)?btoa(a.ArrayBuffer2String(t)):btoa(unescape(encodeURIComponent(t)))},a.decodeBinary=function(e,t){var s=atob(t);return a.isBinary(e)?a.String2ArrayBuffer(s):decodeURIComponent(escape(s))},a.validPath=function(e){if(256<e.length)return!1;for(var t=e.split("/"),s=0;s<t.length;s++)if(!a.validFileName(t[s]))return!1;return!0},a.getFileName=function(e){var t=e.split("/");return t[t.length-1]},a.dataFromURLData=function(e){return e.substr(e.indexOf(",")+1)},a.readZipFile=function(e,t,s,n){function o(l){if(l>=d||s.isClosed())return void n();var e,c=r.entries[l],p=c.fileName;if(p.match(/\/$/))o(l+1);else{s.processFile(p);var g="";if(0===c.compressionMethod?g=c.data:8===c.compressionMethod&&(g=JSInflate.inflate(c.data)),a.isBinary(p))t({name:p,contents:btoa(g),encoding:1}),o(l+1);else{e=a.String2ArrayBuffer(g);var f=new Blob([e],{type:"text/plain"}),u=new FileReader;u.onload=function(s){t({name:p,contents:s.target.result,encoding:0}),o(l+1)},u.onerror=function(t){a.log(t),l=d,o(l+1)},u.readAsText(f)}}}if(n||(n=a.doNothing),"undefined"==typeof JUnzip)return void a.loadScript(["../editor/zip/inflate.js","../editor/zip/unzip.js"],function(){a.readZipFile(e,t,s,n)});var l=a.ArrayBuffer2String(e),r=new JUnzip(l);if(!r.isZipFile())return a.log("Not a ZIP file"),void n();r.readEntries();var d=r.entries.length;o(0)},a.readSelectedFiles=function(e,t,s){function n(l){if(l>=e.length||i.isClosed())return s(),i.close(),void(""<o&&a.showErrorMessage(o));var r=e[l];i.processFile(r.name);var d=a.isBinary(r.name),c=new FileReader,p=a.fileExtension(r.name).toLowerCase();c.onload=function(s){if(!d)t({name:r.name,contents:s.target.result,encoding:0});else if("zip"==p)try{return void a.readZipFile(s.target.result,t,i,function(){n(l+1)})}catch(e){a.showErrorMessage(e+" : "+r.name)}else{var e=a.dataFromURLData(s.target.result);t({name:r.name,contents:e,encoding:1})}n(l+1)},c.onerror=function(t){o+="Error \""+t.target.error+"\" reading "+r.name+"\n",n(l+1)},d?"zip"==p?c.readAsArrayBuffer(r):c.readAsDataURL(r):c.readAsText(r)}var i=new a.progressBar("import","import"),o="";s||(s=a.doNothing),i.processFile=function(e){i.setLabel(e)},n(0)},function(){var e={gif:"image/gif",jpg:"image/jpeg",jpeg:"image/jpeg",png:"image/png",ico:"image/vnd.microsoft.icon",pdf:"application/pdf"};a.getMIME=function(t){var s=a.fileExtension(t);return s in e?e[s]:"application/octet-stream"},a.getTimeLeft=function(e){var t="",s=60,n=60*s,i=24*n;0>e&&(t+="-",e=-e);var a=e,o=parseInt(a/i);a-=o*i,0!==o&&(t+=o+"T");var l=parseInt(a/n);a-=l*n;var r=parseInt(a/s);a-=r*s;var d=parseInt(a);return t+=("00"+l).substr(-2)+":",t+=("00"+r).substr(-2),e<n&&(t+=":"+("00"+d).substr(-2)),t}}(),function(){var e={abap:"abap",abc:"abc",ada:"ada",ads:"ada",adb:"ada",as:"actionscript",as3:"actionscript",asm:"assembly_x86",bash:"sh",bat:"batchfile",c:"c_cpp",C:"c_cpp",cc:"c_cpp",cpp:"c_cpp","c++":"c_cpp",hxx:"c_cpp",h:"c_cpp",H:"c_cpp",cases:"cases",cbl:"cobol",cob:"cobol",coffee:"coffee",clj:"clojure",cs:"csharp",css:"css",d:"d",dart:"dart",e:"eiffel",erl:"erlang",hrl:"erlang",f:"fortran",f77:"fortran",f90:"fortran",for:"fortran",go:"golang",groovy:"groovy",gv:"dot",hs:"haskell",htm:"html",html:"html",hx:"haxe",java:"java",jl:"julia",js:"javascript",json:"json",jsp:"jsp",jsx:"jsx",kt:"kotlin",kts:"kotlin",m:"matlab",md:"markdown",less:"less",lisp:"lisp",lsp:"lisp",lua:"lua",pas:"pascal",p:"pascal",perl:"perl",prl:"perl",php:"php",pro:"prolog",pl:"prolog",py:"python",R:"r",r:"r",rb:"ruby",ruby:"ruby",s:"assembly_x86",sass:"sass",scala:"scala",scm:"scheme",scss:"scss",sh:"sh",swift:"swift",sql:"sql",svg:"svg",tex:"tex",tcl:"tcl",ts:"typescript",twig:"twig",vbs:"vbscript",v:"verilog",vh:"verilog",vhd:"vhdl",vhdl:"vhdl",xml:"xml",yaml:"yaml"};a.langType=function(t){return t in e?e[t]:"plain_text"}}(),function(){var e={},t=/\{\\*\$a\\*}/g;a.str=function(s,n){return e[s]?"undefined"==typeof n?e[s]:e[s].replace(t,n):"{"+s+"}"},a.setStr=function(t){for(var s in t)t.hasOwnProperty(s)&&(e[s]=t[s]);a.dialogbaseOptions={minWidth:200,autoOpen:!1,width:"auto",closeText:a.str("cancel"),modal:!0,dialogClass:"vpl_ide vpl_ide_dialog"}},a.setStr(window.VPLi18n)}(),function(){var e={},t={},s=100,n=0;a.delay=function(t,s,i,a){"undefined"!=typeof e[t]&&(clearTimeout(e[t]),n--),n++,e[t]=setTimeout(function(){n--,s(i,a),delete e[t]},20)},a.longDelay=function(t,i,a,o){"undefined"!=typeof e[t]&&(clearTimeout(e[t]),n--),n++,e[t]=setTimeout(function(){n--,i(a,o),delete e[t]},s)};var i=function(e,a,o,l){return"undefined"!=typeof t[e]&&clearTimeout(t[e]),setTimeout(function(){0<n?t[e]=i(e,a,o,l):(a(o,l),delete t[e])},s)};a.afterAll=function(e,s,n,a){t[e]=i(e,s,n,a)}}(),a.iconModified=function(){var e="<span title=\""+a.str("modified")+"\" class=\"vpl_ide_charicon\">";return e+="<i class=\"fa fa-star\"></i></span> ",e},a.iconDelete=function(){var e=" <span title=\""+a.str("delete")+"\" class=\"vpl_ide_charicon vpl_ide_delicon\">";return e+="<i class=\"fa fa-trash\"></i></span> ",e},a.iconClose=function(){var e=" <span title=\""+a.str("closebuttontitle");return e+="\" class=\"vpl_ide_charicon vpl_ide_closeicon\"><i class=\"fa fa-remove\"></i></span> ",e},a.iconRequired=function(){var e=" <span title=\""+a.str("required")+"\" class=\"vpl_ide_charicon\">";return e+="<i class=\"fa fa-shield\"></i></span> ",e},a.iconFolder=function(){return"<i class=\"fa fa-folder-open-o\"></i>"},function(){var e={filelist:"folder-open-o",filelistclose:"folder-o",new:"file-code-o",rename:"pencil",delete:"trash",multidelete:"trash|list",close:"remove",comments:"commenting",import:"upload",print:"print",edit:"edit",undo:"undo",redo:"repeat",select_all:"location-arrow",find:"search",find_replace:"exchange",next:"search-plus",resetfiles:"refresh",download:"download",fullscreen:"expand",regularscreen:"compress",save:"save",shortcuts:"flash",sort:"list-ol",run:"rocket",running:"rocket fa-spin",debug:"bug",evaluate:"check-square-o",console:"terminal",about:"question",info:"info-circle",alert:"warning",trash:"trash",retrieve:"download",spinner:"refresh fa-spin",keyboard:"keyboard-o",clipboard:"clipboard",timeleft:"clock-o",copy:"copy",paste:"paste",more:"plus-square",less:"minus-square",resize:"arrows-alt",graphic:"picture-o",send:"send",theme:"paint-brush",user:"user",fontsize:"text-height","close-rightpanel":"caret-square-o-right","open-rightpanel":"caret-square-o-left"};a.genIcon=function(t,s){if(!e[t])return"";var n="fa fa-";n+=s?s:"lg";for(var a=e[t].split("|"),o="",l=0;l<a.length;l++)o+="<i class='"+n+" fa-"+a[l]+"'></i>";return o}}(),a.setTitleBar=function(e,t,n,o,l){function r(s){var e="<a id='vpl_"+t+"_"+s+"' href='#' title='"+a.str(s)+"'>";return e+=a.genIcon(s,"fw")+"</a>",e}var d=s(e).parent().find("span.ui-dialog-title"),c=a.genIcon(n);c+=" <span class='"+t+"-title-buttons'></span>",c+="<span class='"+t+"-title-text'></span>",d.html(c);var p=d.find("span."+t+"-title-buttons"),g=d.find("span."+t+"-title-text");c="";for(var f=0;f<o.length;f++)c+=r(o[f]);p.html(c);for(var u,h=0;h<l.length;h++)u=d.find("#vpl_"+t+"_"+o[h]),u.button().click(l[h]),u.css("padding","1px 3px");return p.on("focus","*",function(){s(this).blur()}),g},a.setDialogTitleIcon=function(e,t){var n=s(e).parent().find("span.ui-dialog-title");n.html(a.genIcon(t)+" "+n.html())},a.progressBar=function(e,t,n){var i="<span class=\"vpl_ide_progressbarlabel\"></span>",o="<div class=\"vpl_ide_progressbaricon\">"+a.genIcon("spinner")+"</div>",l=" <div class=\"vpl_ide_progressbar\">"+o+"<span class=\"vpl_ide_progressbarlabel\"></span></div>",r="<div class=\"vpl_ide_dialog\" style=\"display:none;\">"+l+"</div>",d=s(r);s("body").append(d);var c=d.find(".vpl_ide_progressbar"),p=c.find(".vpl_ide_progressbarlabel");d.dialog({title:a.str(e),resizable:!1,autoOpen:!1,width:200,height:20,minHeight:20,modal:!0,dialogClass:"vpl_ide vpl_ide_dialog",close:function(e){d&&(n&&e.originalEvent&&n(),n=!1)}}),this.setLabel=function(e,t){d&&(p.text(e),t&&p.html(a.genIcon(t)+" "+p.html()))},this.close=function(){d&&(d.dialog("destroy"),s(d).remove(),d=!1)},this.isClosed=function(){return!1===d};var g=d.siblings().find(".ui-dialog-title");g.html(a.genIcon(e)+" "+g.html()),this.setLabel(a.str(t)),d.dialog("open"),d.dialog("option","height","auto")},a.showMessage=function(e,t){var n=s.extend({},a.dialogbaseOptions,t),i=s("<div class=\"vpl_ide_dialog\" style=\"display:none\"></div>"),o="",l=" <span class=\"dmessage\">"+e.replace(/\n/g,"<br>")+"</span>";i.html(l),"undefined"==typeof n.icon?o="info":(o=n.icon,delete n.icon),n.title||(n.title=a.str("warning")),s("body").append(i);var r={};"function"==typeof t.ok?(r[a.str("ok")]=function(){s(this).dialog("close"),t.ok()},r[a.str("cancel")]=function(){s(this).dialog("close")},delete n.ok):"function"==typeof t.yes?(r[a.str("yes")]=function(){s(this).dialog("close"),t.yes()},r[a.str("no")]=function(){s(this).dialog("close")},delete n.yes):r[a.str("close")]=function(){s(this).dialog("close")},n.next&&(r[a.str("next")]=function(){s(this).dialog("close"),t.next()}),n.close=function(){s(this).remove(),t.close&&t.close()},n.buttons=r,i.dialog(n);var d=i.siblings().find(".ui-dialog-title");return d.html(a.genIcon(o)+" "+d.html()),i.setMessage=function(e){s(i).find(".dmessage").html(e.replace(/\n/g,"<br>"))},i.dialog("open"),i},a.showErrorMessage=function(e,t){var n=s.extend({},a.dialogbaseOptions,{title:a.str("error"),icon:"alert"});return t&&(n=s.extend(n,t)),a.showMessage(e,n)},a.requestAction=function(e,t,n,i,l){var r=s.Deferred(),d=null,c=!1,p=!1;return l||(""===t&&(t="connecting"),p=new a.progressBar(e,t,function(){4!=d.readyState&&c&&c.abort&&c.abort()})),d=s.ajax({beforeSend:function(e){return c=e,!0},async:!0,type:"POST",url:i+e,data:JSON.stringify(n),contentType:"application/json; charset=utf-8",dataType:"json"}).always(function(){l||p.close()}).done(function(e){e.success?r.resolve(e.response):r.reject(e.error)}).fail(function(e,t,s){var n=a.str("connection_fail")+": "+t;o&&null!=s.message&&(n+=": "+s.message),a.log(n),r.reject(n)}),r},a.supportWebSocket=function(){return!!("WebSocket"in window)},a.isAndroid=function(){return-1<window.navigator.userAgent.indexOf("Android")},a.isFirefox=function(){return-1<window.navigator.userAgent.indexOf("Firefox")},a.isMac=function(){return-1<window.navigator.userAgent.indexOf("Mac")},a.clickServer=function(t){var e=550,n=450,i=screen.width/2-275,o=screen.height/2-n/2;try{var l="toolbar=no, location=no, directories=no, status=no, menubar=no";l+=", resizable=yes, scrollbars=yes, copyhistory=no, width=550",l+=", height="+n+", top="+o+", left="+i;var r=window.open(s(this).attr("href"),"_blank",l);if(!r)return!0}catch(e){return a.log(e),!0}return t.preventDefault(),s(this).parent().hide(),!1},a.acceptCertificates=function(e,t){if(0<e.length){var o=a.str("acceptcertificatesnote");o+="<ol>";var l;for(l in e)if(e.hasOwnProperty(l)){var r=1+l;o+="<li><a href=\""+e[l]+"\" target=\"_blank\">Server ",o+=r+"</a></li>"}o+="</ol>";var d=a.showMessage(o,{ok:function(){var e=t();e&&e()},icon:"unlocked",title:a.str("acceptcertificates")});s(d).find("a").on("click keypress",a.clickServer)}else a.log("servers.length == 0"),a.showErrorMessage(a.str("connection_fail"))},a.monitorRunning=a.returnFalse,function(){var e=-1;a.setProcessId=function(t){e=t},a.getProcessId=function(){return e}}(),a.webSocketMonitor=function(e,t,n,i){a.setProtocol(e),a.setProcessId(e.processid);var o=null,l=null,r=s.Deferred(),d=function(e){r.reject(e)},c=!1,p={message:function(e){var t=/^([^:]*):?([^]*)/.exec(e),s=t[1],o=t[2];"running"==s&&(s=n);var r=a.str(s);""<o&&(r+=": "+o),null===l||l.isClosed()?i.getConsole&&i.getConsole().isOpen()?i.getConsole().setMessage(r):a.log("Error: no dialogo. Message not shown: "+r):l.setLabel(r)},compilation:function(e){i.setResult&&i.setResult({compilation:e},!1)},retrieve:function(){var e={processid:a.getProcessId()};l.close(),c=!0,a.requestAction("retrieve","",e,i.ajaxurl).done(function(e){r.resolve(),i.setResult&&i.setResult(e,!0)}).fail(d)},run:function(t){l.close(),i.run(t,e,o)},close:function(){a.log("ws close message from jail"),o.close();var e={processid:a.getProcessId()};a.requestAction("cancel","",e,i.ajaxurl,!0)}};try{if(a.supportWebSocket())o=new WebSocket(e.monitorURL);else return a.log("ws not available"),r.reject(a.str("browserupdate")),r}catch(t){return a.log("ws new say "+t),r.reject(t.message),r}return l=new a.progressBar(t,"connecting",function(){r.reject("Stopped by user"),o.close()}),o.notOpen=!0,o.onopen=function(){o.notOpen=!1,l.setLabel(a.str("connected")),i.open&&i.open()},o.onerror=function(t){a.log("ws error "+t),l.close(),e.secure&&o.notOpen?a.requestAction("getjails","retrieve",{},i.ajaxurl).done(function(e){a.acceptCertificates(e.servers,function(){return i.getLastAction()})}).fail(d):r.reject(a.str("connection_fail")),i.close&&a.delay("externalActions.close",i.close)},o.onclose=function(){i.getConsole&&i.getConsole().disconnect(),o.notOpen||(l.close(),!c&&"rejected"!=r.state()&&r.resolve()),i.close&&i.close()},o.onmessage=function(e){var t=/^([^:]+):([^]*)/.exec(e.data);if(null!==t){var s=t[1],n=t[2];p[s]&&p[s](n)}else l.setLabel(a.str("error")+": "+e.data)},a.monitorRunning=function(){return null!==o&&o.readyState!=WebSocket.CLOSED},r},a.directRun=function(e,n,i){var o=s.Deferred();return s.ajax({async:!0,type:"POST",url:e+"directrun",data:JSON.stringify({command:n,files:i}),contentType:"application/json; charset=utf-8",dataType:"json"}).done(function(e){if(!e.success)o.reject(e.error);else{var s=e.response;a.setProtocol(s);var n=new WebSocket(s.executionURL);t.debug("Conecting with:"+s.executionURL),o.resolve({processid:s.processid,homepath:s.homepath,connection:n})}}).fail(function(e,s,n){var i="Connection fail: "+s;null!=n.message&&(i+=": "+n.message),t.debug(i),o.reject(i)}),o},a.directRunTest=function(e,s,n){var i=[{name:"a.c",contents:"int main(){return 0;}",encoding:0},{name:"b.c",contents:"int f(){return 1;}",encoding:0}];a.directRun(e,s,i).done(function(e){var s=0;e.connection.onopen=function(){t.debug("Ws open "+e.homepath+" processid "+e.processid),null!=n&&e.connection.send(n),setTimeout(function(){e.connection.close()},600000)},e.connection.onmessage=function(n){t.debug("WS Message ("+ ++s+"): "+n.data),10<=s&&e.connection.close()},e.connection.onerror=function(e){t.debug("WS error: "+e)},e.connection.onclose=function(e){t.debug("WS close: "+e.code+" "+e.reason)}}).fail(function(n){t.debug("Direct run fail. URL: "+e+" command: "+s+" message: "+n)})},a.processResult=function(e,t,s,n,i){function o(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/,"\\$&")}function l(e){return"undefined"==typeof s[e].getTagId?"href=\"#\" ":"href=\"#"+s[e].getTagId()+"\" "}function r(e,n){for(var o=!1,r=0;r<y.length;r++)for(var d,c,p=y[r];null!==(d=p.exec(e));){c=s[r].getAnnotations(),v=r,o=!0;var h;h=-1<e.search(g)?"error":-1<e.search(f)?"warning":-1<e.search(u)?"info":"error",b={row:parseInt(d[5])-1,column:parseInt(d[7]),type:h,text:n},c.push(b);var m=t[r],x=l(r),_=a.sanitizeText(m),w="data-file=\""+m+"\" data-line=\""+parseInt(d[5])+"\"";e=e.replace(p,"<a "+x+" class=\"vpl_fl\" "+w+">"+_+"$2$3$4$5$6</a>"),e=e.substring(e.search("<a "+x+" class=\"vpl_fl\"")),e=e.substring(0,e.search("</a>")+4),s[r].setAnnotations(c)}return!o&&b&&(""===n?b=!1:(b.text+="\n"+n,s[v].setAnnotations(s[v].getAnnotations()))),e}function d(e){var t="";return i&&(t+="<a href=\"javascript:void(0)\" onclick=\"VPLUtil.showHideDiv(this)\">[+]</a>"),t+="<div class=\""+e.class+"\">"+a.sanitizeText(e.line)+"</div>",t}if("undefined"==typeof e||""==e.replace(/^\s+$/gm,""))return"";var c=[{regex:/^<title>.*/,type:"title",class:"ace_identifier vpl_widget_header"},{regex:/^<subTitle>.*/,type:"subTitle",class:"ace_identifier sub_vpl_widget_header"},{regex:/^<subSubTitle>.*/,type:"subSubTitle",class:"ace_identifier sub_sub_vpl_widget_header"},{regex:/^<comment>.*/,type:"comment",class:"ace_comment vpl_evaluate_result"},{regex:/^<testCase>.*/,type:"testCase",class:"ace_identifier vpl_evaluate_result"},{regex:/^<case>.*/,type:"case",class:"ace_identifier vpl_evaluate_result"},{regex:/^<caseEnhanced>.*/,type:"caseEnhanced",class:"ace_string vpl_evaluate_result vpl_enhanced_result"}],p={regex:/<caseOriginal>.*/,class:"ace_tooltip"},g=new RegExp("\\[err\\]|error|"+o(a.str("error")),"i"),f=new RegExp("\\[warn\\]|warning|note|"+o(a.str("warning")),"i"),u=/\[info\]|information/i,h="",m=e.split(/\r\n|\n|\r/),y=[],b=!1,v=!1,x=!1;(function(){for(var e=0;e<t.length;e++){var s=o(t[e]),n={en:"(^| |/)(\"|)"+s+"(\"|)( on line |, line | line |:|\\()(\\d+)(:|,)?(\\d+)?(\\))?",pt_br:"(^| |/)(\"|)"+s+"(\"|)( na linha |, linha | linha |:|\\()(\\d+)(:|,)?(\\d+)?(\\))?"};y[e]=vpl_global_lang&&"string"==typeof n[vpl_global_lang]?new RegExp(n[vpl_global_lang],"m"):new RegExp(n.en,"m")}})();var _=[];m.forEach(e=>{var t=c.some(t=>!!t.regex.test(e)&&(_.push({line:e.replace("<"+t.type+">",""),type:t.type,class:t.class}),!0));t||_.push({line:e,type:"",class:""})});var w=[];_.forEach((e,t,s)=>{if("caseEnhanced"==e.type){for(var n=t;n+1<s.length&&!p.regex.exec(s[n].line);)n++;n<s.length&&w.push({beginId:t,endId:n})}});var j=0;w.forEach(e=>{if(e.beginId<e.endId){var t=_.splice(e.beginId-j,e.endId-e.beginId+1),s={type:t[0].type,line:t.map(e=>e.line).join("<br>"),class:t[0].class};_.splice(e.beginId-j,0,s),j=j+e.endId-e.beginId}}),_=_.filter(e=>""!==e.line);var T={loading:!1,buffer:""},k=1;return _.forEach(e=>{if(n)return void(h+=r(a.sanitizeText(e),e)+"\n");switch(e.type){case"title":h+=d(e);break;case"subTitle":var t=a.sanitizeText(e.line);h+="<div class=\""+e.class+"\">"+t+"</div>",!0==T.loading?(T.loading=!1,t=a.sanitizeText(T.buffer),r(t,T.buffer)):(T.loading=!0,T.buffer="");break;case"caseEnhanced":var s=p.regex.exec(e.line),i="";null!=s&&(e.line=e.line.substring(0,s.index),i=`<div class="${p.class}" id="enhancedPop${k}" style="display: none; left: 0px; top: 0px;">`+s[0].substring(14,s[0].length)+"</div>");var o=e.line.split("<br>");o.forEach(t=>{var n=a.sanitizeText(t);h+=`<div class="${e.class}"`+(s?` onmouseover="enhancedMouseOver(event, ${k})"`+` onmousemove="enhancedMouseMove(event, ${k})"`+` onmouseout="enhancedMouseOut(event, ${k})"`:"")+">"+`${n}</div>`+i,T.buffer+=t+"\n"}),k++;break;case"case":T.buffer+=e.line+"\n";case"caseTest":default:var t=a.sanitizeText(e.line);h+="<div class=\""+e.class+"\">"+t+"</div>";}}),x&&(h+="</div>"),h},function(){var e=[];a.loadScript=function(t,s){if(0==t.length)return void s();var n=t[0];if("undefined"==typeof e[n]){t.shift(),e[n]=1;var i=document.createElement("script");i.type="text/javascript",i.src=a.options.scriptPath+n,i.onload=function(){e[n]=2,a.loadScript(t,s)},document.head.appendChild(i)}else 2==e[n]?(t.shift(),a.loadScript(t,s)):(a.log("Error loading js "+n+" "+e[n]),setTimeout(function(){a.loadScript(t,s)},50))},a.isScriptLoading=function(t){return"undefined"!=typeof e[t]&&1==e[t]},a.isScriptLoaded=function(t){return"undefined"!=typeof e[t]&&2==e[t]}}(),a.adjustBlockly=function(e,t,s){for(var n,a=e.getAllBlocks(),o=2e4,l=-2e4,r=2e4,d=-2e4,c=0;c<a.length;c++)n=a[c].getRelativeToSurfaceXY(),o=Math.min(o,n.y),l=Math.max(l,n.y),r=Math.min(r,n.x),d=Math.max(d,n.x);a=e.getTopBlocks();for(var p=0;p<a.length;p++)a[p].moveBy(t-r,s-o);return l-o+100+s},function(){function e(e,t){var s=this;this.files=e,this.results=t,setTimeout(function(){s.highlight()},10)}var t=[],n=[],o=[];e.prototype.highlightBlockly=function(e){a.loadScript(["../editor/blockly/blockly_compressed.js","../editor/blockly/msg/js/en.js","../editor/blockly/blocks_compressed.js"],function(){var t=s("#"+e),n=t.html();s("#"+e+"load").remove(),t.html(""),t.show(),n=s("<div />").html(n).text().replace(/\n/g,"");var i=Blockly.Xml.textToDom(n);t.html("").height(300).width(t.parent().width());var o={toolbox:"",readOnly:!0,media:"../editor/blockly/media/"},l=Blockly.inject(e,o);Blockly.Xml.domToWorkspace(i,l);var r=a.adjustBlockly(l,10,10);t.height(r),t.width("100%"),Blockly.svgResize(l),Blockly.resizeSvgContents(l);var d=t.html();l.dispose(),t.html(d)})},e.prototype.highlight=function(){var e=this,t=!1,n=this.files;for(let e,s=0;s<n.length;s++)if(e=n[s],a.isBinary(e.fileName)||a.isBlockly(e.fileName))continue;else{t=!0;break}if(t&&"undefined"==typeof ace)return void a.loadScript(["../editor/ace9/ace.js"],function(){e.highlight()});var i=this.results,l=[],r=[];for(let t=0;t<n.length;t++){let i=n[t],g="code"+i.tagId;if(a.isBlockly(i.fileName)){e.highlightBlockly(g);continue}var d=a.fileExtension(i.fileName),c=a.langType(d);s("#"+g).show(),s("#"+g+"load").remove();var p=ace.edit(g);p.setTheme("ace/theme/"+i.theme),p.getSession().setMode("ace/mode/"+c),p.renderer.setShowGutter(i.showln),p.setReadOnly(!0),p.setHighlightActiveLine(!1),p.setAutoScrollEditorIntoView(!0),p.setOption("maxLines",i.nl),p.getAnnotations=function(){return this.getSession().getAnnotations()},p.setAnnotations=function(e){return this.getSession().setAnnotations(e)},p.getTagId=function(){return this.vplTagId},p.vplTagId=i.tagId,l.push(p),r.push(i.fileName),o[i.tagId]=p}for(var g=0;g<i.length;g++){var f=document.getElementById(i[g].tagId),u=f.textContent||f.innerText;f.innerHTML=a.processResult(u,r,l,i[g].noFormat,i[g].folding)}},a.addResults=function(e,t,s){n.push({tagId:e,noFormat:t,folding:s})},a.syntaxHighlightFile=function(e,s,n,i,a){t.push({tagId:e,fileName:s,theme:n,showln:i,nl:a})},a.syntaxHighlight=function(){new e(t,n),t=[],n=[]},a.flEventHandler=function(e){var t=e.target.getAttribute("href").substring(1),s=e.target.getAttribute("data-line"),n=o[t];n.gotoLine(s,0),n.scrollToLine(s,!0)},a.setflEventHandler=function(){for(var e=document.getElementsByClassName("vpl_fl"),t=0;t<e.length;t++)e[t].onclick=a.flEventHandler},a.showHideDiv=function(e){var t=e,s=e;for(s.nextSibling||(s=s.parentNode),s=s.nextSibling;"DIV"!=s.nodeName&&"PRE"!=s.nodeName;)if(s=s.nextSibling,!s)return;t&&("[+]"==t.innerHTML?(s.style.display=s.savedDisplay?s.savedDisplay:"",t.innerHTML="[-]"):(s.savedDisplay=s.style.display,s.style.display="none",t.innerHTML="[+]"))}}(),a.options={scriptPath:""},"undefined"!=typeof window.VPLDebugMode&&(o=window.VPLDebugMode),a.init=function(e){a.options={scriptPath:""},s.extend(a.options,e),"undefined"!=typeof window.VPLDebugMode&&(o=window.VPLDebugMode),a.log(a.options)},window.VPLUtil=a,a});