define(["mod_vpl/vplutil"],function(a){return{init:function(b){function c(c){a.showErrorMessage(c,{next:b.next})}b.next=function(){window.location=b.nexturl};var d,e={ajaxurl:b.ajaxurl,run:c,getLastAction:function(){d()}};d=function(){a.requestAction("evaluate","evaluating",{},b.ajaxurl).done(function(d){a.webSocketMonitor(d,"evaluate","evaluating",e).done(b.next).fail(c)}).fail(c)},d()}}});