{"version":3,"file":"vplvnc.min.js","names":["define","$","jqui","VPLUtil","VPLClipboard","console","window","INCLUDE_URI","loadVNCScripts","Util","delay","load_scripts","VPLVNCClient","VNCDialogId","str","self","rfb","title","message","lastState","VNCDialog","canvas","onCloseAction","doNothing","clipboard","needResize","titleText","inputarea","document","createElement","style","position","left","top","width","height","opacity","backgroundColor","borderStyle","outlineStyle","autocapitalize","autocomplete","autocorrect","wrap","spellcheck","append","keyboardButton","is","blur","focus","pasteClipboard","isConnected","clipboardPasteFrom","getEntry2","receiveClipboard","text","setEntry1","openClipboard","show","getFocus","get_keyboard","set_focused","lostFocus","copyAction","getEntry1","execCommand","HTMLUpdateClipboard","genIcon","HTMLPaste","on","e","target","displayResize","w","h","setCanvasSize","get_display","viewportChange","controlDialogSize","bw","bh","dialog","parent","prev","outerHeight","closeOnEscape","autoOpen","modal","dialogClass","create","setTitleBar","dragStop","open","beforeClose","close","disconnect","resizeStop","css","updateTitle","setTitle","t","setMessage","updateState","state","oldstate","msg","log","connect","secure","host","port","password","path","onClose","RFB","set_local_cursor","get_cursor_uri","isOpen","hide","round","v","Math","floor","getCanvasSize"],"sources":["../src/vplvnc.js"],"sourcesContent":["// This file is part of VPL for Moodle - http://vpl.dis.ulpgc.es/\n//\n// VPL for Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// VPL for Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with VPL for Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * VNC client control\n *\n * @copyright 2014 Juan Carlos Rodríguez-del-Pino\n * @license http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n * @author Juan Carlos Rodríguez-del-Pino <jcrodriguez@dis.ulpgc.es>\n */\n\n/* globals RFB */\n/* globals Util */\n\ndefine(\n    [\n        'jquery',\n        'jqueryui',\n        'mod_vpl/vplutil',\n        'mod_vpl/vplclipboard',\n        'core/log'\n    ],\n    function($, jqui, VPLUtil, VPLClipboard, console) {\n        window.INCLUDE_URI = \"../editor/noVNC/include/\";\n        /**\n         * Load VNC Script after the Util (\"util.js\" is loaded\n         */\n        function loadVNCScripts() {\n            if (typeof Util == 'undefined') {\n                VPLUtil.delay('loadVNCScripts', loadVNCScripts);\n            } else {\n                Util.load_scripts([\"webutil.js\", \"base64.js\", \"websock.js\", \"des.js\",\n                \"keysymdef.js\", \"keyboard.js\", \"input.js\", \"display.js\",\n                \"jsunzip.js\", \"rfb.js\", \"keysym.js\"]);\n            }\n        }\n        VPLUtil.delay('loadVNCScripts', loadVNCScripts);\n        var VPLVNCClient = function(VNCDialogId, str) {\n            var self = this;\n            var rfb;\n            var title = '';\n            var message = '';\n            var lastState = '';\n            var VNCDialog = $('#' + VNCDialogId);\n            var canvas = $('#' + VNCDialogId + \" canvas\");\n            var onCloseAction = VPLUtil.doNothing;\n            var clipboard;\n            var needResize = true;\n            var titleText;\n            var inputarea = window.document.createElement('input');\n            inputarea.style.position = 'absolute';\n            inputarea.style.left = '0px';\n            inputarea.style.top = '-10000px';\n            inputarea.style.width = '1em';\n            inputarea.style.height = '1ex';\n            inputarea.style.opacity = '0';\n            inputarea.style.backgroundColor = 'transparent';\n            inputarea.style.borderStyle = 'none';\n            inputarea.style.outlineStyle = 'none';\n            inputarea.autocapitalize = 'off';\n            inputarea.autocomplete = 'off';\n            inputarea.autocorrect = 'off';\n            inputarea.wrap = 'off';\n            inputarea.spellcheck = 'false';\n            VNCDialog.append(inputarea);\n            /**\n             * Event handler of keyboard button.\n             */\n            function keyboardButton() {\n                if ($(inputarea).is(':focus')) {\n                    inputarea.blur();\n                } else {\n                    inputarea.focus();\n                }\n            }\n            /**\n             * Event handler of paste button at clipboard.\n             */\n            function pasteClipboard() {\n                if (self.isConnected()) {\n                    rfb.clipboardPasteFrom(clipboard.getEntry2());\n                }\n            }\n            /**\n             * Event handler of paste button at clipboard.\n             *\n             * @param {object} rfb vnc client object\n             * @param {string} text Text received\n             */\n            function receiveClipboard(rfb, text) {\n                clipboard.setEntry1(text);\n            }\n            /**\n             * Event handler of clipboard button.\n             */\n            function openClipboard() {\n                clipboard.show();\n            }\n            /**\n             * Inform rfb of focus received.\n             */\n            function getFocus() {\n                if (self.isConnected()) {\n                    rfb.get_keyboard().set_focused(true);\n                }\n            }\n            /**\n             * Inform rfb of focus lost.\n             */\n            function lostFocus() {\n                if (self.isConnected()) {\n                    rfb.get_keyboard().set_focused(false);\n                }\n            }\n            /**\n             * Tries to do a copy.\n             */\n            function copyAction() {\n                clipboard.setEntry1(clipboard.getEntry1());\n                document.execCommand('copy');\n            }\n            var HTMLUpdateClipboard = VPLUtil.genIcon('copy', 'sw') + ' ' + str('copy');\n            var HTMLPaste = VPLUtil.genIcon('paste', 'sw') + ' ' + str('paste');\n            clipboard = new VPLClipboard('vpl_dialog_vnc_clipboard', HTMLUpdateClipboard, copyAction, HTMLPaste, pasteClipboard,\n                    lostFocus);\n            canvas.on('click', function(e) {\n                if (e.target == canvas[0]) {\n                    getFocus();\n                } else {\n                    lostFocus();\n                }\n            });\n            this.displayResize = function() { // TODO hot screen resize.\n                if (self.isConnected()) {\n                    var w = VNCDialog.width();\n                    var h = VNCDialog.height();\n                    self.setCanvasSize(w, h);\n                    rfb.get_display().viewportChange(0, 0, w, h);\n                }\n            };\n            /**\n             * Event handler that limit the size of the vnc client windows.\n             *\n             */\n            function controlDialogSize() {\n                // Resize if dialog is large than screen.\n                var bw = $('html').width();\n                var bh = $(window).height();\n                if (VNCDialog.width() > bw) {\n                    needResize = true;\n                    VNCDialog.dialog(\"option\", \"width\", bw);\n                }\n                if (VNCDialog.parent().height() > bh) {\n                    needResize = true;\n                    VNCDialog.dialog(\"option\", \"height\", bh - VNCDialog.prev().outerHeight());\n                }\n            }\n            VNCDialog.dialog({\n                closeOnEscape: false,\n                autoOpen: false,\n                modal: true,\n                width: 'auto',\n                height: 'auto',\n                dialogClass: 'vpl_ide vpl_vnc',\n                create: function() {\n                    titleText = VPLUtil.setTitleBar(VNCDialog, 'vnc', 'graphic', ['clipboard', 'keyboard'], [openClipboard,\n                            keyboardButton]);\n                },\n                dragStop: controlDialogSize,\n                focus: getFocus,\n                open: controlDialogSize,\n                beforeClose: function() {\n                    if (needResize) {\n                        var w = VNCDialog.width();\n                        var h = VNCDialog.height();\n                        needResize = false;\n                        self.setCanvasSize(w, h);\n                    }\n                },\n                close: function() {\n                    self.disconnect();\n                },\n                resizeStop: function() {\n                    controlDialogSize();\n                    needResize = true;\n                }\n            });\n            VNCDialog.css(\"padding\", \"1px\");\n            VNCDialog.parent().css('z-index', 2000);\n            this.updateTitle = function() {\n                var text = title;\n                if (message !== '') {\n                    text += ' (' + message + ')';\n                }\n                titleText.text(str('console') + \": \" + text);\n            };\n            this.setTitle = function(t) {\n                title = t;\n                this.updateTitle();\n            };\n            this.setMessage = function(t) {\n                message = t;\n                this.updateTitle();\n            };\n            /**\n             * Event handler to show vnc client state in windows title.\n             *\n             * @param {object} rfb vnc client\n             * @param {string} state Name of the state\n             * @param {string} oldstate Name of the old state. Not used\n             * @param {string} msg State detail message\n             */\n            function updateState(rfb, state, oldstate, msg) {\n                lastState = state;\n                switch (state) {\n                    case \"normal\":\n                        self.setMessage('');\n                        self.setTitle(str('connected'));\n                        break;\n                    case \"disconnect\":\n                    case \"disconnected\":\n                        self.setTitle(str('connection_closed'));\n                        break;\n                    case \"failed\":\n                        self.setTitle(str('connection_fail'));\n                        console.log(\"VNC client: \" + msg);\n                        break;\n                    default:\n                        self.setMessage('');\n                        self.setTitle(str('connecting'));\n                }\n            }\n\n            this.connect = function(secure, host, port, password, path, onClose) {\n                clipboard.setEntry1('');\n                onCloseAction = onClose;\n                self.show();\n                var target = $('#' + VNCDialogId + \" canvas\")[0];\n                if (!rfb) {\n                    rfb = new RFB({\n                        'target': target,\n                        'encrypt': secure,\n                        'repeaterID': '',\n                        'true_color': true,\n                        'local_cursor': true,\n                        'shared': false,\n                        'view_only': false,\n                        'onUpdateState': updateState,\n                        'onPasswordRequired': null,\n                        'onClipboard': receiveClipboard\n                    });\n                    rfb.set_local_cursor(rfb.get_display().get_cursor_uri());\n                }\n                if (!port) {\n                    port = secure ? 443 : 80;\n                }\n                rfb.connect(host, port, password, path);\n            };\n            this.isOpen = function() {\n                return VNCDialog.dialog(\"isOpen\");\n            };\n            this.close = function() {\n                VNCDialog.dialog(\"close\");\n            };\n            this.isConnected = function() {\n                return rfb && lastState != 'disconnected';\n            };\n            this.disconnect = function() {\n                if (rfb) {\n                    rfb.disconnect();\n                }\n                onCloseAction();\n                clipboard.hide();\n            };\n            /**\n             * Round a number to event and not less than 100.\n             *\n             * @param {number} v value to round\n             *\n             * @returns {int}\n             */\n            function round(v) {\n                if (v < 100) {\n                    v = 100;\n                }\n                return Math.floor(v / 2) * 2;\n            }\n            this.getCanvasSize = function() {\n                return canvas.width() + \"x\" + canvas.height();\n            };\n\n            this.setCanvasSize = function(w, h) {\n                canvas.width(round(w));\n                canvas.height(round(h));\n            };\n            this.show = function() {\n                VNCDialog.dialog('open');\n                VNCDialog.width('auto');\n                VNCDialog.height('auto');\n            };\n            self.setCanvasSize($(window).width() - 150, $(window).height() - 150);\n        };\n        return VPLVNCClient;\n    }\n);\n"],"mappings":"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"}